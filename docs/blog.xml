<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Angelo Maria Sabatini</title>
<link>https://amsabatini.netlify.app/blog.html</link>
<atom:link href="https://amsabatini.netlify.app/blog.xml" rel="self" type="application/rss+xml"/>
<description>This the personal blog of Angelo Maria Sabatini</description>
<generator>quarto-1.5.52</generator>
<lastBuildDate>Wed, 05 Jun 2024 22:00:00 GMT</lastBuildDate>
<item>
  <title>Numerical simulation for stochastic differential equations</title>
  <dc:creator>Angelo Maria Sabatini</dc:creator>
  <link>https://amsabatini.netlify.app/posts/numerical_simulation/</link>
  <description><![CDATA[ 




<p>We consider here the class of stochastic processes known as diffusion processes, which are solutions to stochastic differential equation (SDE) of the form:</p>
<p><span id="eq-eq1"><img src="https://latex.codecogs.com/png.latex?%0AdX(t)=b(t,X(t))%5C,dt+%5Csigma(t,X(t))%5C,dW(t)%0A%5Ctag%7B1%7D"></span></p>
<p>with some initial condition <img src="https://latex.codecogs.com/png.latex?X(0)"> which can be regarded as being either constant or random. The SDE is interpreted in the Itô sense:</p>
<p><span id="eq-eq2"><img src="https://latex.codecogs.com/png.latex?%0AX(t)=X(0)+%5Cint_0%5Etb(s,X(s))%5C,ds+%5Cint_0%5Et%5Csigma(s,X(s))%5C,dW(s)%0A%5Ctag%7B2%7D"></span></p>
<p>and <img src="https://latex.codecogs.com/png.latex?%5C%7BW(t),t%5Cin%5B0,T%5D%5C%7D"> is the so-called Brownian motion or Wiener process.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Wiener process
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Wiener process <img src="https://latex.codecogs.com/png.latex?%5C%7BW(t),t%5Cin%5B0,T%5D%5C%7D"> has independent Gaussian increments and continuous sample paths, and comes endowed with the following properties:</p>
<ol type="1">
<li><p><img src="https://latex.codecogs.com/png.latex?W(0)=0"> (with probability 1).</p></li>
<li><p>For <img src="https://latex.codecogs.com/png.latex?0%5Cleq%20s%5Cleq%20t%5Cleq%20T"> the random variable given by the Gaussian increment <img src="https://latex.codecogs.com/png.latex?W(t)-W(s)"> is distributed with mean zero and variance <img src="https://latex.codecogs.com/png.latex?t-s">; equivalently, <img src="https://latex.codecogs.com/png.latex?W(t)-W(s)%5Cpropto%5Csqrt%7Bt-s%7D%5C,Z">, where <img src="https://latex.codecogs.com/png.latex?Z"> denotes a standard Gaussian random variable, with a mean of zero and a variance of one.</p></li>
<li><p>For <img src="https://latex.codecogs.com/png.latex?0%5Cleq%20s%5Cleq%20t%5Cleq%20u%5Cleq%20v%5Cleq%20T"> the increments <img src="https://latex.codecogs.com/png.latex?W(t)-W(s)"> and <img src="https://latex.codecogs.com/png.latex?W(v)-W(u)"> are independent (condition of independence on any two disjoint intervals).</p></li>
</ol>
</div>
</div>
<p>The two deterministic functions <img src="https://latex.codecogs.com/png.latex?b(%5Ccdot,%5Ccdot)"> and <img src="https://latex.codecogs.com/png.latex?%5Csigma(%5Ccdot,%5Ccdot)"> are called, respectively, the drift and the diffusion coefficients of the SDE. Under a number of assumptions regarding their properties (i.e., global Lipschitz and linear growth, see <span class="citation" data-cites="iacus2008">(Iacus 2008)</span> for mathematical details) the SDE has a unique solution with continuous sample paths such that</p>
<p><span id="eq-eq3"><img src="https://latex.codecogs.com/png.latex?%0AE%5Cleft%5B%5Cint_0%5ET%5Cvert%5C,X(t)%5C,%5Cvert%5E2%5C,dt%5Cright%5D%3C%5Cinfty%0A%5Ctag%7B3%7D"></span></p>
<p>For the sake of simpler notation, <img src="https://latex.codecogs.com/png.latex?X(t)%5Crightarrow%20X_t"> is used in the following, therefore Equation&nbsp;1 and Equation&nbsp;2 can be written:</p>
<p><span id="eq-eq4"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0AdX_t&amp;=b(t,X_t)%5C,dt+%5Csigma(t,X_t)%5C,dW_t%5C%5C%0AX_t&amp;=X_0+%5Cint_0%5Etb(s,X_s)%5C,ds+%5Cint_0%5Et%5Csigma(s,X_s)%5C,dW_s%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B4%7D"></span></p>
<p>The Itô formula is an important tool of stochastic calculus. It can be regarded as the stochastic version of the Taylor expansion of a function <img src="https://latex.codecogs.com/png.latex?f(t,X_t)"> stopped at the second order, where <img src="https://latex.codecogs.com/png.latex?X_t"> is a diffusion process. If the function <img src="https://latex.codecogs.com/png.latex?f(%5Ccdot,%5Ccdot)"> is a twice differentiable function on both arguments, we have:</p>
<p><span id="eq-eq5"><img src="https://latex.codecogs.com/png.latex?%0Adf(t,X_t)=f_t(t,X_t)%5C,dt+f_x(t,X_t)%5C,dX_t+%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D(t,X_t)(dX_t)%5E2%0A%5Ctag%7B5%7D"></span></p>
<p>where:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af_t(t,x)=%5Cdfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7Df(t,x),%5Cquad%20f_x(t,x)=%5Cdfrac%7B%5Cpartial%20f(t,x)%7D%7B%5Cpartial%20x%7D,%5Cquad%20f_%7Bxx%7D(t,x)=%5Cdfrac%7B%5Cpartial%5E2%20f(t,x)%7D%7B%5Cpartial%20x%5E2%7D%0A"></p>
<p>Using Equation&nbsp;1 and the Itô lemma, which states that <img src="https://latex.codecogs.com/png.latex?(dW_t)%5E2=dt">, we have:</p>
<p><span id="eq-eq6"><img src="https://latex.codecogs.com/png.latex?%0A(dX_t)%5E2=%5Cleft%5Bb(t,X_t)%5C,dt+%5Csigma(t,X_t)%5C,dW_t%5Cright%5D%5E2=%5Csigma%5E2(t,X_t)%5C,dt+%5Ctext%7BO%7D(dt%5E%7B3/2%7D)%0A%5Ctag%7B6%7D"></span></p>
<p>Equation&nbsp;5 can thus be written:</p>
<p><span id="eq-eq7"><img src="https://latex.codecogs.com/png.latex?%0Adf(t,X_t)=%5Cleft%5Bf_t(t,X_t)+f_x(t,X_t)b(t,X_t)+%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D(t,X_t)%5Cright%5Ddt+f_x(t,X_t)%5Csigma(t,X_t)%5C,dW_t%0A%5Ctag%7B7%7D"></span></p>
<section id="approximation-methods" class="level2">
<h2 class="anchored" data-anchor-id="approximation-methods">Approximation methods</h2>
<p>To apply a numerical method to the generic SDE of Equation&nbsp;1 over the time interval <img src="https://latex.codecogs.com/png.latex?%5B0,T%5D">, the time interval needs to be discretized <span class="citation" data-cites="higham.2001">(Higham 2001)</span>. Let <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t=T/M"> for some positive integer <img src="https://latex.codecogs.com/png.latex?M">, and <img src="https://latex.codecogs.com/png.latex?t_n=n%5CDelta%20t">. The numerical approximation to <img src="https://latex.codecogs.com/png.latex?X(t_n)"> will be denoted <img src="https://latex.codecogs.com/png.latex?X_n"> (<img src="https://latex.codecogs.com/png.latex?n=1,%5Ccdots,M">).</p>
<p>The Euler-Maruyama method takes the form:</p>
<p><span id="eq-eq8"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0AX_n&amp;=X_%7Bn-1%7D+b(X_%7Bn-1%7D)%5CDelta%20t+%5Csigma(X_%7Bn-1%7D)%5CDelta%20W_%7Bn-1%7D%5C%5C%0AX_0&amp;=x_0%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B8%7D"></span></p>
<p>It is worth noting that in the case when <img src="https://latex.codecogs.com/png.latex?%5Csigma(X_t)=0">, then the problem becomes deterministic: this approximation method reduces to the standard Euler method for the ordinary differential equation <img src="https://latex.codecogs.com/png.latex?%5Cdot%7BX%7D_t=b(t,X_t)">.</p>
<p>The Milstein’s method adds a correction to the stochastic increment to produce the solution to the SDE. The correction arises because the Taylor expansion must be modified in the case of Itô calculus. Truncating the Taylor expansion to the second order at an appropriate point yields:</p>
<p><span id="eq-eq9"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0AX_n&amp;=X_%7Bn-1%7D+b(t_%7Bn-1%7D,X_%7Bn-1%7D)%5CDelta%20t+%5Csigma(t_%7Bn-1%7D,X_%7Bn-1%7D)%5CDelta%20W_%7Bn-1%7D%5C%5C%0A&amp;+%5Cdfrac%7B1%7D%7B2%7D%5Csigma(X_%7Bn-1%7D)%5Csigma_x(X_%7Bn-1%7D)%5Cleft%5B(%5CDelta%20W_%7Bn-1%7D)%5E2-%5CDelta%20t%5Cright%5D%5C%5C%0AX_0&amp;=x_0%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B9%7D"></span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Strong and weak convergence
</div>
</div>
<div class="callout-body-container callout-body">
<p>The methods of approximation of the continuous solution to an SDE are classified according to their different properties. Mainly two criteria of optimality are used in the literature: the strong and the weak (orders of) convergence.</p>
<p>A time-discretized approximation <img src="https://latex.codecogs.com/png.latex?X_%5Cdelta"> of a continuous-time process <img src="https://latex.codecogs.com/png.latex?X">, with <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t"> the time increment of the discretization, is said to be of strong order of convergence <img src="https://latex.codecogs.com/png.latex?%5Cgamma"> to <img src="https://latex.codecogs.com/png.latex?X"> if for any fixed time horizon <img src="https://latex.codecogs.com/png.latex?T"> it holds true that</p>
<p><span id="eq-eq10"><img src="https://latex.codecogs.com/png.latex?%0AE%5B%5C,%5Cvert%20X_%7B%5CDelta%20t%7D(%5Ctau)-X(%5Ctau)%5Cvert%5C,%5D%5Cleq%20C%5CDelta%20t%5E%5Cgamma,%5Cquad%5Cforall%5CDelta%20t%3C%5CDelta%20t_0%0A%5Ctag%7B10%7D"></span></p>
<p>for any <img src="https://latex.codecogs.com/png.latex?%5Ctau%5Cin%5B0,T%5D">, with <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t_0%3E0"> and <img src="https://latex.codecogs.com/png.latex?C"> a constant that does not depend on <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t">.</p>
<p>Along with the strong convergence, the weak convergence can also be defined. In the same conditions as above, <img src="https://latex.codecogs.com/png.latex?X_%7B%5CDelta%20t%7D"> is said to converge weakly of order <img src="https://latex.codecogs.com/png.latex?%5Cgamma"> to <img src="https://latex.codecogs.com/png.latex?X"> if for any fixed horizon <img src="https://latex.codecogs.com/png.latex?T"> and any <img src="https://latex.codecogs.com/png.latex?2(%5Cbeta+1)"> continuous differentiable function <img src="https://latex.codecogs.com/png.latex?g"> of polynomial growth, it holds true that</p>
<p><span id="eq-eq11"><img src="https://latex.codecogs.com/png.latex?%0A%5Cvert%5C,E_g%5BX_%7B%5CDelta%20t%7D(%5Ctau)%5D-E_g%5BX(%5Ctau)%5D%5C,%5Cvert%5Cleq%20C%5CDelta%20t%5E%5Cbeta%0A%5Ctag%7B11%7D"></span></p>
<p>for any <img src="https://latex.codecogs.com/png.latex?%5Ctau%5Cin%5B0,T%5D">, with <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t_0%3E0"> and <img src="https://latex.codecogs.com/png.latex?C"> a constant that does not depend on <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t">.</p>
<p>Whereas the strong order of convergence measures the rate at which the <em>mean of the error</em> decays as <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t%5Crightarrow0">, the weak order of convergence measures the rate of decay of the <em>error of the means</em>.</p>
<p>Methods of approximation of some order that strongly converge usually have a higher order of weak convergence. This is the case with the Euler-Maruyama method, which is strongly convergent of order <img src="https://latex.codecogs.com/png.latex?%5Cgamma=1/2"> and weakly convergent of order <img src="https://latex.codecogs.com/png.latex?%5Cbeta=1"> (under some smoothness conditions on the coefficients of the SDE). The Milstein’s method has both weak and strong order of convergence, <img src="https://latex.codecogs.com/png.latex?%5Cgamma=%5Cbeta=1">, which is superior to the Euler–Maruyama method.</p>
<p>It is interesting noting that, when the diffusion coefficient does not depend on the state variable of the process, the Euler-Maruyama and Milstein’s methods coincide. This is one important case, therefore, when the Euler-Maruyama method is strongly convergent of order <img src="https://latex.codecogs.com/png.latex?%5Cgamma=1">.</p>
</div>
</div>
</section>
<section id="numerical-test" class="level2">
<h2 class="anchored" data-anchor-id="numerical-test">Numerical test</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Geometric Brownian motion
</div>
</div>
<div class="callout-body-container callout-body">
<p>The geometric Brownian motion (GBM) is the solution to the SDE:</p>
<p><span id="eq-eq12"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0AdX_t&amp;=%5Clambda%5C,X_t%5C,dt+%5Cmu%5C,X_t%5C,dW_t%5C%5C%0AX_0&amp;=x_0%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B12%7D"></span></p>
<p>where the parameter <img src="https://latex.codecogs.com/png.latex?%5Clambda"> is interpreted as the constant interest rate and <img src="https://latex.codecogs.com/png.latex?%5Cmu%3E0"> as the volatility. For a GBM, the drift and diffusion coefficients are both linearly related to the state variable <img src="https://latex.codecogs.com/png.latex?X">, namely <img src="https://latex.codecogs.com/png.latex?b(t,X_t)=%5Clambda%5C,X_t"> and <img src="https://latex.codecogs.com/png.latex?%5Csigma(X_t)=%5Cmu%5C,X_t">.</p>
<p>The explicit solution of the SDE Equation&nbsp;12 can be found by operating the following change of variable:</p>
<p><span id="eq-eq13"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0AY_t=%5Clog%20X_t%5Cquad%5Crightarrow%5Cquad%20dY_t&amp;=%5Cfrac%7B1%7D%7BX_t%7D%5C,dX_t-%5Cfrac%7B1%7D%7B2X_t%5E2%7D%5C,(dX_t)%5E2%5C%5C%0A&amp;=%5Cleft(%5Clambda-%5Cfrac%7B1%7D%7B2%7D%5Cmu%5E2%5Cright)dt+%5Cmu%5C,dW_t%0A%5Cend%7Bsplit%7D%0A%5Ctag%7B13%7D"></span></p>
<p>We obtain:</p>
<p><span id="eq-eq14"><img src="https://latex.codecogs.com/png.latex?%0AX_t=x_0%5Cexp%5Cleft%5B%5Cleft(%5Clambda-%5Cfrac%7B1%7D%7B2%7D%5Cmu%5E2%5Cright)t+%5Cmu%5C,W_t%5Cright%5D%0A%5Ctag%7B14%7D"></span></p>
</div>
</div>
<p>For the GBM, the following stochastic difference equations are obtained for the Euler-Maruyama method:</p>
<p><span id="eq-eq15"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0AX%5EE_n&amp;=X%5EE_%7Bn-1%7D(1+%5Clambda%5CDelta%20t+%5Cmu%5CDelta%20W_%7Bn-1%7D)%5C%5C%0AX%5EE_0&amp;=x_0%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B15%7D"></span></p>
<p>and for the Milstein method:</p>
<p><span id="eq-eq16"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0AX%5EM_n&amp;=X%5EM_%7Bn-1%7D+%5Clambda%20X%5EM_%7Bn-1%7D%5CDelta%20t+%5Cmu%20X%5EM_%7Bn-1%7D%5CDelta%20W_%7Bn-1%7D%5C%5C%0A&amp;+%5Cdfrac%7B1%7D%7B2%7D%5Cmu%5E2%20X%5EM_%7Bn-1%7D%5Cleft%5B(%5CDelta%20W_%7Bn-1%7D)%5E2-%5CDelta%20t%5Cright%5D%5C%5C%0A&amp;=X%5EM_%7Bn-1%7D%5Cleft%5B1+%5Cleft(%5Clambda-%5Cdfrac%7B1%7D%7B2%7D%5Cmu%5E2%5Cright)%5CDelta%20t+%5Cmu%5CDelta%20W_%7Bn-1%7D+%5Cdfrac%7B1%7D%7B2%7D%5Cmu%5E2(%5CDelta%20W_%7Bn-1%7D)%5E2%5Cright%5D%5C%5C%0AX%5EM_0&amp;=x_0%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B16%7D"></span></p>
<p>Recall that <img src="https://latex.codecogs.com/png.latex?%5CDelta%20W_%7Bn-1%7D=%5Csqrt%7B%5CDelta%20t%7D%5C,Z">, where <img src="https://latex.codecogs.com/png.latex?Z%5Cpropto%20N(0,1)">.</p>
<p>Equation&nbsp;15 reads:</p>
<p><span id="eq-eq17"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0AX%5EE_n&amp;=X%5EE_%7Bn-1%7D(1+%5Clambda%5CDelta%20t+%5Cmu%5Csqrt%7B%5CDelta%20t%7D%5C,Z)%5C%5C%0AX%5EE_0&amp;=x_0%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B17%7D"></span></p>
<p>Equation&nbsp;16 reads:</p>
<p><span id="eq-eq18"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0AX%5EM_n&amp;=X%5EM_%7Bn-1%7D%5Cleft%5B1+%5Cleft(%5Clambda+%5Cdfrac%7B1%7D%7B2%7D%5Cmu%5E2(Z%5E2-1)%5Cright)%5CDelta%20t+%5Cmu%5Csqrt%7B%5CDelta%20t%7D%5C,Z%5Cright%5D%5C%5C%0AX%5EM_0&amp;=x_0%5C%5C%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B18%7D"></span></p>
<p>Comparing the exact solution Equation&nbsp;14 with Equation&nbsp;18 shows how the Milstein method makes the Taylor expansion exact up to order <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BO%7D(%5CDelta%20t)">.</p>
<p>The following code will test the strong convergence of both methods when they are applied to the linear SDE Equation&nbsp;12, with <img src="https://latex.codecogs.com/png.latex?%5Clambda=2,%5Cmu=1,x_0=1">. One thousand sample paths are simulated over the time interval <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D">, for step sizes being integer multiples of <img src="https://latex.codecogs.com/png.latex?2%5E%7B-9%7D%5C;(8,4,2,1)">. The order of convergence is tested at the end point of the chosen time interval. The results of the simulations are shown in Figure&nbsp;1.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1792</span>)</span>
<span id="cb1-4">lambda  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> </span>
<span id="cb1-5">mu      <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-6">Xzero   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-7">T       <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-8">N       <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span></span>
<span id="cb1-9">dt      <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>N</span>
<span id="cb1-10">M       <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb1-11">Xerr_EM <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> M, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb1-12">Xerr_M  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> M, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, M, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) {</span>
<span id="cb1-15">  dW    <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(dt))</span>
<span id="cb1-16">  W     <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(dW)</span>
<span id="cb1-17">  Xtrue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> Xzero<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>((lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>mu<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>T <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> mu<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>W[N])</span>
<span id="cb1-18">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {</span>
<span id="cb1-19">    R  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(j<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>)    </span>
<span id="cb1-20">    Dt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> R<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>dt </span>
<span id="cb1-21">    L  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> N<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>R</span>
<span id="cb1-22">    Xtemp_EM <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> Xzero</span>
<span id="cb1-23">    Xtemp_M  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> Xzero</span>
<span id="cb1-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (k <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) {</span>
<span id="cb1-25">      Winc     <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(dW[(R<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(k<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(R<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>k)])</span>
<span id="cb1-26">      Xtemp_EM <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> Xtemp_EM<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> mu<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>Winc)</span>
<span id="cb1-27">      Xtemp_M  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> Xtemp_M<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>lambda <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>mu<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(Winc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Dt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> mu<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>Winc)</span>
<span id="cb1-28">    }</span>
<span id="cb1-29">    Xerr_EM[i, j] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(Xtemp_EM <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Xtrue)</span>
<span id="cb1-30">    Xerr_M[i, j]  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(Xtemp_M <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Xtrue)</span>
<span id="cb1-31">  }</span>
<span id="cb1-32">}</span>
<span id="cb1-33">Dtvals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>dt</span>
<span id="cb1-34">Xm_EM  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">array</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dim =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb1-35">Xm_M   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">array</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dim =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb1-36"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) {</span>
<span id="cb1-37">  Xm_EM[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(Xerr_EM[, i])</span>
<span id="cb1-38">  Xm_M[i]  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(Xerr_M[, i])</span>
<span id="cb1-39">}</span>
<span id="cb1-40">t   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(Dtvals, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-41">g   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Euler-Maruyama"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Milstein"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb1-42">e   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(Xm_EM, Xm_M)</span>
<span id="cb1-43">e_t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(t), t)</span>
<span id="cb1-44">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> t, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> g, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">error =</span> e, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">error_true =</span> e_t)</span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/numerical_simulation/index_files/figure-html/fig-fig1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Strong error plot for the Euler-Maruyama and Milstein’s methods; dashed lines give the appropriate reference slope for each method, <img src="https://latex.codecogs.com/png.latex?%5Cgamma=0.5"> (Euler-Maruyama) and <img src="https://latex.codecogs.com/png.latex?%5Cgamma=1"> (Milstein).
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="lamperti-transform" class="level2">
<h2 class="anchored" data-anchor-id="lamperti-transform">Lamperti transform</h2>
<p>An interesting application of the Itô formula Equation&nbsp;7 is now discussed in connection with a formulation of Equation&nbsp;4 where the diffusion coefficient is not an explicit function of time, but only depends on the state variable <img src="https://latex.codecogs.com/png.latex?X">:</p>
<p><span id="eq-eq19"><img src="https://latex.codecogs.com/png.latex?%0AdX_t=b(t,X_t)%5C,dt+%5Csigma(X_t)%5C,dW_t%0A%5Ctag%7B19%7D"></span></p>
<p>The Lamperti transform is defined as follows:</p>
<p><span id="eq-eq20"><img src="https://latex.codecogs.com/png.latex?%0AY_t=F(X_t)=%5Cint_z%5E%7BX_t%7D%5Cfrac%7B1%7D%7B%5Csigma(s)%7D%5C,ds%0A%5Ctag%7B20%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?z"> is any arbitrary value in the state space of <img src="https://latex.codecogs.com/png.latex?X">. We assume that the function <img src="https://latex.codecogs.com/png.latex?F(%5Ccdot)"> defines a one-to-one mapping from the state space of <img src="https://latex.codecogs.com/png.latex?X"> to <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D">. We have:</p>
<p><span id="eq-eq21"><img src="https://latex.codecogs.com/png.latex?%0AF_t(X_t)=0%5Cquad%5Cquad%20F_x(X_t)=%5Cdfrac%7B1%7D%7B%5Csigma(X_t)%7D%5Cquad%5Cquad%20F_%7Bxx%7D(X_t)=-%5Cdfrac%7B%5Csigma_x(X_t)%7D%7B%5Csigma%5E2(X_t)%7D%0A%5Ctag%7B21%7D"></span></p>
<p>Applying the Itô formula Equation&nbsp;5, we obtain:</p>
<p><span id="eq-eq22"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0AdY_t&amp;=%5Cleft%5B%5Cdfrac%7Bb(t,X_t))%7D%7B%5Csigma(X_t)%7D-%5Cdfrac%7B1%7D%7B2%7D%5Csigma_x(X_t)%5Cright%5Ddt+dW_t%5C%5C%0AX_t&amp;=F%5E%7B-1%7D(Y_t)%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B22%7D"></span></p>
<p>The Lamperti transform changes the generic SDE Equation&nbsp;4 into another SDE with unitary diffusion coefficient. As an example of application of the Lamperti transform, we consider here a result on transformations of SDEs that is relevant for the topic of interest in this post.</p>
<p>First, we discretize the Lamperti transform of Equation&nbsp;22 using the Euler-Maruyama method (see Equation&nbsp;8):</p>
<p><span id="eq-eq23"><img src="https://latex.codecogs.com/png.latex?%0AY_n=Y_%7Bn-1%7D+%5Cleft%5B%5Cdfrac%7Bb(t_%7Bn-1%7D,X_%7Bn-1%7D)%7D%7B%5Csigma(X_%7Bn-1%7D)%7D-%5Cdfrac%7B1%7D%7B2%7D%5Csigma_x(X_%7Bn-1%7D)%5Cright%5D%5CDelta%20t+%5Csqrt%7B%5CDelta%20t%7D%5C,Z%0A%5Ctag%7B23%7D"></span></p>
<p>Second, we apply the Taylor expansion to the inverse transform <img src="https://latex.codecogs.com/png.latex?X_t=G(Y_t)">, noting that:</p>
<p><span id="eq-eq24"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0AG_y(Y_t)&amp;=%5Csigma(G(Y_t))%5C%5C%0AG_%7Byy%7D(Y_t)&amp;=%5Csigma(G(Y_t))%5Csigma_x(G(Y_t))%0A%5Cend%7Bsplit%7D%0A%5Ctag%7B24%7D"></span></p>
<p>We obtain:</p>
<p><span id="eq-eq25"><img src="https://latex.codecogs.com/png.latex?%0AG(Y_%7Bn%7D)=G(Y_%7Bn-1%7D)+G_y(Y_%7Bn-1%7D)(Y_n-Y_%7Bn-1%7D)+%5Cfrac%7B1%7D%7B2%7DG_%7Byy%7D(Y_%7Bn-1%7D)(Y_n-Y_%7Bn-1%7D)%5E2%0A%5Ctag%7B25%7D"></span></p>
<p>and hence:</p>
<p><span id="eq-eq26"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0AX_n&amp;=X_%7Bn-1%7D+%5Cleft%5Bb(t_%7Bn-1%7D,X_%7Bn-1%7D)-%5Cdfrac%7B1%7D%7B2%7D%5Csigma(X_%7Bn-1%7D)%5Csigma_x(X_%7Bn-1%7D)%5Cright%5D%5CDelta%20t%5C%5C%0A&amp;+%5Csigma(X_%7Bn-1%7D)%5Csqrt%7B%5CDelta%20t%7D%5C,Z+%5Cfrac%7B1%7D%7B2%7D%5Csigma(X_%7Bn-1%7D)%5Csigma_x(X_%7Bn-1%7D)%5CDelta%20t%5C,Z%5E2%0A%5Cend%7Bsplit%7D%0A%5Ctag%7B26%7D"></span></p>
<p>In conclusion, the Milstein method on the original process and the Euler-Maruyama method on the transformed process are equal up to and including the order <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BO%7D(%5CDelta%20t)">.</p>
<p>In general if a transformation such as the Lamperti transform eliminates the interactions between the state of the process and the increments of the Wiener process, the performance of the Euler-Maruyama method on the transformed SDE are expected to improve.</p>
<p>The logarithmic transformation <img src="https://latex.codecogs.com/png.latex?F(X_t)=%5Clog%20X_t"> is an example of nonlinear transformation that is capable of eliminating the interaction between the state <img src="https://latex.codecogs.com/png.latex?X_t"> of the GBM process and the increments of the Wiener process <img src="https://latex.codecogs.com/png.latex?dW_t">, as shown in Equation&nbsp;13. Therefore the Euler-Maruyama method can be confidently applied to the transformed process; the Milstein method is then obtained by simply taking the Taylor expansion of the inverse transform.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-higham.2001" class="csl-entry">
Higham, Desmond J. 2001. <span>“An Algorithmic Introduction to Numerical Simulation of Stochastic Differential Equations.”</span> <em>SIAM Review</em> 43 (3): 525–46. <a href="https://doi.org/10.1137/s0036144500378302">https://doi.org/10.1137/s0036144500378302</a>.
</div>
<div id="ref-iacus2008" class="csl-entry">
Iacus, Stefano M. 2008. <em>Simulation and Inference for Stochastic Differential Equations</em>. Springer New York. <a href="https://doi.org/10.1007/978-0-387-75839-8">https://doi.org/10.1007/978-0-387-75839-8</a>.
</div>
</div></section></div> ]]></description>
  <category>stochastic calculus</category>
  <guid>https://amsabatini.netlify.app/posts/numerical_simulation/</guid>
  <pubDate>Wed, 05 Jun 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Significant figures</title>
  <dc:creator>Angelo Maria Sabatini</dc:creator>
  <link>https://amsabatini.netlify.app/posts/significant_figures/</link>
  <description><![CDATA[ 




<section id="significant-figures" class="level2">
<h2 class="anchored" data-anchor-id="significant-figures">Significant figures</h2>
<p>It happens frequently that the number of digits that are available to report measurement results is high. Usually, measurement results are produced by carrying arithmetic operations with computers or calculators, whose level of numerical precision, albeit finite, is too high given the true information gathered by the measurements. In other words, the precision can be excessive, and too many digits can simply swamp the observer, making the message in the measurements more obscure. <strong>Significant figures</strong>, also referred to as significant digits, are specific digits within a number written in positional notation that carry both reliability and necessity in reporting a measurement result. Proper use of significant figures is thus an essential element in the presentation of both experimental and calculated results together with their associated uncertainty.</p>
<section id="rules-for-significant-figures" class="level3">
<h3 class="anchored" data-anchor-id="rules-for-significant-figures">Rules for significant figures</h3>
<p>A number of rules exist for determining how many significant figures are in a number:</p>
<ol type="1">
<li>non-zero digits are always significant</li>
</ol>
<ul>
<li>4.6 has two significant figures</li>
</ul>
<ol start="2" type="1">
<li>leading zeros placed before the first non-zero digit are not significant (they are called <em>placeholders</em>)</li>
</ol>
<ul>
<li>0.046 has two significant figures</li>
</ul>
<ol start="3" type="1">
<li>trailing zeros placed after all other digits but behind a decimal point are significant</li>
</ol>
<ul>
<li>4.60 has three significant figures</li>
</ul>
<p>The leftmost digit which is not a zero is referred to as the <em>most significant digit</em> (MSD); the rightmost digit of a decimal number is the <em>least significant digit</em> (LSD), regardless it is a zero or not: 4 and 0 are thus, respectively, the MSD and the LSD of 4.60; 4 and 1 are, respectively, the MSD and the LSD of 4.61. Every digit between the LSD and the MSD, including zeros, should be counted as significant figures, hence 4.60 and 40.60 have, respectively, three and four significant figures.</p>
<p>Ambiguous situations arise when zeros are at the end of the number and not behind a decimal point as, for example, in the number 4600. Confusion can be avoided if the number is expressed in <em>scientific notation</em>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Scientific notation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Scientific notation is a way of expressing numbers that are much too large or much too small to be conveniently written in decimal form (i.e., their representation would involve a long string of digits). In scientific notation, nonzero numbers are written in the form:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Am%5Ctimes10%5En%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?n"> is an integer, and the coefficient <img src="https://latex.codecogs.com/png.latex?m"> is a nonzero real number (usually <img src="https://latex.codecogs.com/png.latex?1%5Cleq%5Cvert%5C,m%5C,%5Cvert%3C10">). The integer <img src="https://latex.codecogs.com/png.latex?n"> is called the <em>exponent</em> and the real number <img src="https://latex.codecogs.com/png.latex?m"> is called the <em>mantissa</em>. If the number is negative, then a minus sign precedes <img src="https://latex.codecogs.com/png.latex?m">, as in ordinary decimal notation.</p>
</div>
</div>
<p>In scientific notation, the number 4600 can be written using a different number of significant figures, based on rule 3. above:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A4.600%5Ctimes%2010%5E3&amp;%5Cquad%5Ctext%7Bfour%20significant%20figures%7D%5C%5C%0A4.60%5Ctimes%2010%5E3&amp;%5Cquad%5Ctext%7Bthree%20significant%20figures%7D%5C%5C%0A4.6%5Ctimes%2010%5E3&amp;%5Cquad%5Ctext%7Btwo%20significant%20figures%7D%0A%5Cend%7Bsplit%7D%0A"></p>
</section>
<section id="rounding" class="level3">
<h3 class="anchored" data-anchor-id="rounding">Rounding</h3>
<p>A number can be <em>rounded</em> so as to drop digits until a prescribed number of significant figures is retained in the final representation. Recall that all the digits after the decimal point to the right of the desired LSD are to be dropped and not replaced with zeros, which otherwise should add to the number of significant figures (rule 3 above). The rules of rounding are the following:</p>
<ol type="1">
<li>if the digit to the right of the desired LSD is greater than 5, add 1 to the LSD, otherwise do nothing</li>
</ol>
<ul>
<li>Example - round at the fourth significant figure</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A53.8%5Cunderline%7B7%7D4&amp;%5Crightarrow53.87%5C%5C%0A53.8%5Cunderline%7B7%7D9&amp;%5Crightarrow53.88%0A%5Cend%7Bsplit%7D%0A"></p>
<ol start="2" type="1">
<li>if the digit to the right of the LSD is 5, apply a tie-breaking rule, also called the <em>five rule</em>. When the first digit to be dropped is 5, the leading digit next to it is examined. If this digit is even, including zero, it is left unaltered; otherwise, one unit is added. This helps avoiding the accumulation of errors that would be otherwise determined by rounding systematically up or down. Using the five rule, five out of ten cases consist of rounding up and five out of ten cases consist of rounding down.</li>
</ol>
<ul>
<li>Example - round at the fifth significant figure</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A726.8%5Cunderline%7B0%7D51%5Crightarrow%20726.80%5C%5C%0A726.8%5Cunderline%7B3%7D51%5Crightarrow%20726.84%5C%5C%0A726.8%5Cunderline%7B6%7D51%5Crightarrow%20726.86%5C%5C%0A726.8%5Cunderline%7B9%7D51%5Crightarrow%20726.90%0A%5Cend%7Bsplit%7D%0A"></p>
</section>
</section>
<section id="finite-precision-arithmetic" class="level2">
<h2 class="anchored" data-anchor-id="finite-precision-arithmetic">Finite precision arithmetic</h2>
<p>In mathematical operations involving significant figures, the result cannot be more precise than the least precise number. Calculations in finite precision arithmetic can be done following a few simple rules. One rule applies to multiplication and division, and another rule applies to addition and subtraction. Recall that values that are considered exact numbers, e.g., known conversion factors or physical constants, are not to be included in the determination of the number of significant figures.</p>
<section id="multiplication-and-division" class="level3">
<h3 class="anchored" data-anchor-id="multiplication-and-division">Multiplication and division</h3>
<blockquote class="blockquote">
<p>When we multiply/divide two numbers, we should add their relative uncertainties. The uncertainty of the result is given roughly by the number of the digits, regardless of their placement.</p>
</blockquote>
<p>In a calculation involving multiplication/division the number of significant figures in the result should equal the least number of significant figures in any one of the numbers being multiplied or divided.</p>
<p>In the following example, the number 1.6 is reported with two significant figures; the number 2, seen as a known constant, can be considered having an infinite number of significant figures, whereas the number 2.0 has two significant figures. The result should be reported with two significant figures in both cases:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A&amp;1.6%5Ctimes2=3.2&amp;%5C%5C%0A&amp;1.61%5Ctimes2.0=3.2&amp;%5Cquad%5Ctext%7Bnot%7D%5C;3.22%0A%5Cend%7Bsplit%7D%0A"></p>
</section>
<section id="addition-and-subtraction" class="level3">
<h3 class="anchored" data-anchor-id="addition-and-subtraction">Addition and subtraction</h3>
<blockquote class="blockquote">
<p>When we add/subtract two numbers, we should add their uncertainties. The uncertainty of the result is given roughly by the placement of the digits, not by the number of digits.</p>
</blockquote>
<p>In a calculation involving addition/subtraction, the number of decimal places in the result should equal the least number of decimal places in any one of the numbers being added or subtracted.</p>
<p>In the following example, the number 132.03 is reported with five significant figures, and the number 3.210 is reported with four significant figures. However, when the two numbers are added, what matters really is the number of decimal places, i.e., two for the number 132.03 and three for the number 3.210. The result should be reported with two decimal digits and not reported using four significant figures.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A&amp;132.03+3.210=135.24&amp;%5C;%5Ctext%7Band%20not%7D%5C;135.2%5C%5C%0A&amp;132.03+3=135&amp;%5C;%5Ctext%7Band%20not%7D%5C;135.03%5C%5C%0A&amp;132.03+3.00=135.03&amp;%5C;%5Ctext%7Band%20not%7D%5C;135%5C%5C%0A%5Cend%7Bsplit%7D%0A"></p>
<p>The prescription about the minimum number of decimal places of any of the numbers involved in the calculation can be explained by considering that, implicitly, the precision of any measurement is dictated by the decimal place. For a measurement of length expressed in meters, for example, the second decimal digit implies a measurement precise to the hundredths (centimeter-level), the third decimal digit to the thousandth (millimeter-level). So by keeping the result with the minimum number of decimal places we basically state that we do not want to imply to get a result more precise than the least precise measurement that was needed to produce the result itself.</p>
</section>
<section id="multiple-arithmetic-operations" class="level3">
<h3 class="anchored" data-anchor-id="multiple-arithmetic-operations">Multiple arithmetic operations</h3>
<blockquote class="blockquote">
<p>In a calculation involving multiple arithmetic operations, the rules are applied without rounding results after each intermediate step. Instead keep track of the rightmost digit that would be retained. The operations would be performed in the following order:</p>
</blockquote>
<ul>
<li><p>operations in parentheses ( )</p></li>
<li><p>multiplication</p></li>
<li><p>division</p></li>
<li><p>addition</p></li>
<li><p>subtraction</p></li>
</ul>
<p>It is important to always perform intermediate calculations without rounding the numbers that are involved in the operations. If numbers are rounded every time during many sequential calculations, the results are skewed and some systematic error is surely introduced. Only after that all calculations are carried out with all digits retained at each step, the final result has to be rounded to the desired number of significant figures.</p>
<p>As an example, two numbers reported with five significant figures each are added, and the final result is rounded to three significant figures. If the addends are first rounded to three significant figures and then added, the result we produce is wrong:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A&amp;1.4248+1.2732=2.6980%5Crightarrow%202.70&amp;%5Cquad%5Ctext%7Bcorrect%7D%5C%5C%0A&amp;1.42+1.27=2.69%5Crightarrow%202.70&amp;%5Cquad%5Ctext%7Bwrong%7D%0A%5Cend%7Bsplit%7D%0A"></p>
<div id="exm-exm1" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (Sequential calculation)</strong></span> Suppose that we want to perform the following operation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(2.5%5Ctimes3.42)+13.681-0.1%0A"></p>
<ol type="1">
<li>perform first the product between parentheses - we keep track of the first decimal place, which would be retained based on rule B above.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0A2.5%5Ctimes3.42=8.%5Cunderline%7B5%7D500%0A"></p>
<ol start="2" type="1">
<li>perform addition - although, based on rule A above, the result would be expressed using five significant figures, only the first decimal place is kept tracked:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0A8.5500+13.681=22.%5Cunderline%7B2%7D310%0A"></p>
<ol start="3" type="1">
<li>perform subtraction:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0A22.2310-0.1=22.%5Cunderline%7B1%7D31%0A"></p>
<ol start="4" type="1">
<li>rounding to three significant figures:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0A(2.5%5Ctimes3.42)+13.681-0.1%5Crightarrow22.1%0A"></p>
</div>
<p>When doing multi-step calculations, we need:</p>
<ul>
<li><p>to keep at least one more significant figure in intermediate results than needed in the final answer. Furthermore, never round intermediate answers: rounding, say, to two significant figures in an intermediate answer, and then writing three significant figures in the final answer is wrong.</p></li>
<li><p>not to write more significant figures in the final result (of a measurement process) than justified (by the measurement uncertainty).</p></li>
</ul>
</section>
</section>
<section id="significant-figures-and-measurement-uncertainty" class="level2">
<h2 class="anchored" data-anchor-id="significant-figures-and-measurement-uncertainty">Significant figures and measurement uncertainty</h2>
<p>The value of one measurand must be delivered by rounding the digit loaded by the measurement uncertainty <img src="https://latex.codecogs.com/png.latex?U">, where <img src="https://latex.codecogs.com/png.latex?U"> is represented by a number with, usually, no more than one or two significant figures (rounded up, possibly). The additional uncertainty due to rounding must be checked for being negligible compared to <img src="https://latex.codecogs.com/png.latex?U">. Essentially, <img src="https://latex.codecogs.com/png.latex?U"> gives an estimate of the errors incurred in the measurement.</p>
<p>For example, if we have a length <img src="https://latex.codecogs.com/png.latex?L=(12.37%5Cpm0.10)%5C;%5Ctext%7Bcm%7D">, we can report the length as <img src="https://latex.codecogs.com/png.latex?L=12.4%5C;%5Ctext%7Bcm%7D">. When we express a number with three significant figures, what we are saying is that the first two digits are essentially exactly correct, and the last one is uncertain by a small amount (generally it is only uncertain by about <img src="https://latex.codecogs.com/png.latex?%5Cpm1">). In the example above, we rounded our answer to <img src="https://latex.codecogs.com/png.latex?12.4%5C;%5Ctext%7Bcm%7D"> because our answer is uncertain to <img src="https://latex.codecogs.com/png.latex?%5Cpm0.1%5C;%5Ctext%7Bcm%7D">, namely our answer is uncertain in the last digit by about 1.</p>
<div id="exm-exm2" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 (Rounding)</strong></span> Round the measurement <img src="https://latex.codecogs.com/png.latex?z=12.0349%5C;%5Ctext%7Bcm%7D">, whose uncertainty is stated being <img src="https://latex.codecogs.com/png.latex?%5CDelta%20z=0.153%5C;%5Ctext%7Bcm%7D">.</p>
<ol type="1">
<li>round the uncertainty to two significant figures:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5CDelta%20z=0.15%5C,%5Ctext%7Bcm%7D%0A"></p>
<ol start="2" type="1">
<li>round <img src="https://latex.codecogs.com/png.latex?z"> using the same number of decimal places as <img src="https://latex.codecogs.com/png.latex?%5CDelta%20z">:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0Az=12.03%5C,%5Ctext%7Bcm%7D%0A"></p>
<ol start="3" type="1">
<li>provide the measurement report:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0Az%5Cpm%5CDelta%20z=(12.03%5Cpm0.15)%5C,%5Ctext%7Bcm%7D%0A"></p>
</div>
<div id="exm-exm3" class="theorem example">
<p><span class="theorem-title"><strong>Example 3 (Use of the scientific notation)</strong></span> When the answer is given in scientific notation, the uncertainty should be given in scientific notation with the same power of ten as the answer. Suppose that <img src="https://latex.codecogs.com/png.latex?z=1.43%5Ctimes10%5E6%5C;%5Ctext%7Bs%7D"> and <img src="https://latex.codecogs.com/png.latex?%5CDelta%20z=2%5Ctimes10%5E4%5C;%5Ctext%7Bs%7D">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Az%5Cpm%5CDelta%20z=(1.43%5Cpm0.02)%5C,10%5E6%5C;%5Ctext%7Bs%7D%0A"></p>
</div>
<div id="exm-exm4" class="theorem example">
<p><span class="theorem-title"><strong>Example 4 (Addition/subtraction of uncertain numbers)</strong></span> The length of two blocks is measured, and the measurements are <img src="https://latex.codecogs.com/png.latex?l_1=1.13%5C;%5Ctext%7Bm%7D"> (considered precise to the level of centimeters) and <img src="https://latex.codecogs.com/png.latex?l_2=0.551%5C;%5Ctext%7Bm%7D"> (considered precise to the level of millimeters). We need to compute the length <img src="https://latex.codecogs.com/png.latex?l"> of the block resulting from stacking the two blocks together:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Al=l_1+l_2=1.681%5C;%5Ctext%7Bm%7D%5Crightarrow%20l=1.68%5C;%5Ctext%7Bm%7D%0A"></p>
<p>It does not make any physical sense to consider the length of the overall block precise to the level of the millimeters, given that one of the two blocks is measured less precisely. The result should be at least as precise as the least precise term involved in the addition, as stated by the rule for addition/subtraction of uncertain numbers.</p>
</div>
<div id="exm-exm5" class="theorem example">
<p><span class="theorem-title"><strong>Example 5 (Multiplication/division of uncertain numbers)</strong></span> A rectangular floor needs to be covered by a number of squared tiles. According to the measurements that are available, the rectangular floor has width <img src="https://latex.codecogs.com/png.latex?w=1.91%5C;%5Ctext%7Bm%7D"> and length <img src="https://latex.codecogs.com/png.latex?l=1.57%5C;%5Ctext%7Bm%7D"> and each squared tile has size <img src="https://latex.codecogs.com/png.latex?a=0.15%5C;%5Ctext%7Bm%7D">. All measurements are considered precise to the level of centimeters, and three significant figures should then be considered for their numerical representation. The number of tiles can be easily calculated:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AN%5Capprox%5Cdfrac%7Bw%5C,l%7D%7Ba%5E2%7D=133.2756%5C;%5Ctext%7Bm%7D%5E2%5C,%5Ctext%7Bm%7D%5E%7B-2%7D%0A"></p>
<p>To comply with the rule for multiplication/division between uncertain numbers, <img src="https://latex.codecogs.com/png.latex?133.2756"> has to be rounded using three significant figures, yielding the integer <img src="https://latex.codecogs.com/png.latex?N=133">, which is then the number of tiles expected to cover the floor.</p>
</div>
<div id="exm-exm6" class="theorem example">
<p><span class="theorem-title"><strong>Example 6 (Conversion of scale)</strong></span> A measurement of temperature is performed, leading to the following report:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_c=(54.0%5Cpm0.5)%5C;%5E%7B%5Ccirc%7D%5Ctext%7BC%7D%0A"></p>
<p>We want to convert this expression in units of kelvin:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_K=T_C+273.15=(327.15%5Cpm0.5)%5C;%5Ctext%7BK%7D%0A"></p>
<p>The uncertainty expressed in degree Celsius (<img src="https://latex.codecogs.com/png.latex?%5Cpm0.5%5C;%5E%7B%5Ccirc%7D%5Ctext%7BC%7D">) translates directly in the uncertainty expressed in kelvin (<img src="https://latex.codecogs.com/png.latex?%5Cpm%200.5%5C;%5Ctext%7BK%7D">). This is because transforming a measurement expressed in degree Celsius into a measurement expressed in kelvin implies a change of offset, but not a change of scale. Since the uncertainty loads the first decimal digit of the numerical representation of the measured temperature, we should report <img src="https://latex.codecogs.com/png.latex?T_K"> with one decimal digit, which requires rounding (based on the five rule):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_k=(327.2%5Cpm0.5)%5C;%5Ctext%7BK%7D%0A"></p>
<p>The prescription of the minimum number of significant figures (rule for the addition/subtraction of uncertain numbers) would yield <img src="https://latex.codecogs.com/png.latex?T_k=327%5C;%5Ctext%7BK%7D">. This is because <img src="https://latex.codecogs.com/png.latex?54.0"> has three significant figures, and <img src="https://latex.codecogs.com/png.latex?273.15"> can be considered to have an infinite number of significant figures, since it is a known constant; hence <img src="https://latex.codecogs.com/png.latex?T_K"> should be reported with three significant figures according to the rule for addition/subtraction of uncertain numbers. However, this rule is superseded by considering the prescription concerning how to express the measurement uncertainty.</p>
</div>
<blockquote class="blockquote">
<p>The concept of significant figures and their relation with measurement uncertainty has been briefly reviewed. This topic is important because many measured quantities are often reported with more significant figures than necessary, in the face of the loaded uncertainty. Reporting too many digits is confusing for the reader and of no relevance as for the information content associated to the measurements.</p>
</blockquote>


</section>

 ]]></description>
  <category>measurement</category>
  <guid>https://amsabatini.netlify.app/posts/significant_figures/</guid>
  <pubDate>Mon, 13 May 2024 22:00:00 GMT</pubDate>
  <media:content url="https://amsabatini.netlify.app/posts/significant_figures/significant_figures.png" medium="image" type="image/png" height="150" width="144"/>
</item>
<item>
  <title>Augmented Dickey-Fuller test</title>
  <dc:creator>Angelo Maria Sabatini</dc:creator>
  <link>https://amsabatini.netlify.app/posts/dickey_fuller/</link>
  <description><![CDATA[ 




<section id="stationary-time-series" class="level2">
<h2 class="anchored" data-anchor-id="stationary-time-series">Stationary time series</h2>
<p>Roughly, for a time series to be stationary three conditions are needed:</p>
<ul>
<li><p>it shows mean reversion, namely it fluctuates around a constant long-term mean</p></li>
<li><p>it has finite variance that is time-invariant.</p></li>
<li><p>autocorrelations decay relatively fast as lag lenghts increase.</p></li>
</ul>
<p>The identification of stationary series can be done by checking whether the autocorrelation function (ACF) drops to zero relatively quickly; usually, the ACF of non-stationary data decreases slowly, and the first-lag value is often large and positive. However, this method is necessarily imprecise, leading to ambiguous situations that cannot be easily deciphered, especially when the sample size is small.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Backshift notation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The backward shift operator <img src="https://latex.codecogs.com/png.latex?B"> is defined as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ABY_t=Y_%7Bt-1%7D%0A"></p>
<p>The operator <img src="https://latex.codecogs.com/png.latex?B"> operates on the <img src="https://latex.codecogs.com/png.latex?t">th sample of a time series, with the effect of shifting the sample back one period (first difference). Recall that two applications of the backward shift operator to <img src="https://latex.codecogs.com/png.latex?Y_t"> shift the sample back two periods (second difference):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AB(BY_t)=B%5E2Y_t=Y_%7Bt-2%7D%0A"></p>
<p>For example, in the case of monthly data, if we wish to consider <em>the same month last year</em>, the notation is <img src="https://latex.codecogs.com/png.latex?B%5E%7B12%7DY_t=Y_%7Bt-12%7D">.</p>
<p>The backward shift operator is useful to describe the operation of <strong>differencing</strong>, the technique of election to stabilize the mean value of nonstationary time series by removing changes in the level of a time series, and therefore eliminating (or reducing) trend and seasonality.</p>
<p>A first-order difference is defined as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AY%5E%7B%5Cprime%7D_t=Y_t-Y_%7Bt-1%7D=Y_t-BY_t=(1-B)Y_t%0A"></p>
<p>If a second-order difference is considered, namely the first-order difference of a first-order difference, we can write:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0AY%5E%7B%5Cprime%5Cprime%7D_t&amp;=Y%5E%7B%5Cprime%7D_t-Y%5E%7B%5Cprime%7D_%7Bt-1%7D%5C%5C%0A&amp;=(1-B)%5E2Y_t=Y_t-2BY_t+B%5E2Y_t%5C%5C%0A&amp;=Y_t-2Y_%7Bt-1%7D+Y_%7Bt-2%7D%0A%5Cend%7Bsplit%7D%0A"></p>
<p>A <img src="https://latex.codecogs.com/png.latex?d">-order difference can be written <img src="https://latex.codecogs.com/png.latex?(1-B)%5Ed">. It is important to note that a second-order difference, denoted by <img src="https://latex.codecogs.com/png.latex?(1-B)%5E2">, is not the same as a second difference, which is denoted by <img src="https://latex.codecogs.com/png.latex?B%5E2">.</p>
<p>For example, a seasonal difference followed by a first difference can be written:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0AY%5E%7B%5Cprime%7D_t&amp;=(1-B)(1-B%5E%7B12%7D)Y_t%5C%5C%0A&amp;=(1-B-B%5E%7B12%7D-B%5E%7B13%7D)Y_t%5C%5C%0A&amp;=Y_t-Y_%7Bt-1%7D-Y_%7Bt-12%7D-Y_%7Bt-13%7D%0A%5Cend%7Bsplit%7D%0A"></p>
<p>Sometimes, as I will always do in the following of this post, the notation <img src="https://latex.codecogs.com/png.latex?%5CDelta"> is also used to indicate the first-order difference, i.e., <img src="https://latex.codecogs.com/png.latex?%5CDelta%20Y_t=(1-B)Y_t">.</p>
</div>
</div>
<p>A <strong>unit root process</strong>, also called difference-stationary process (DSP), is a data-generating process whose first difference is stationary.</p>
<p>There are two basic models for time series with linear growth characteristics:</p>
<ul>
<li>Trend stationary process</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0AY_t=c+%5Cdelta%20t+%5Ctext%7Bstationary%20process%7D%0A"></p>
<ul>
<li>Unit root process</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0AY_t=Y_%7Bt-1%7D+%5Ctext%7Bstationary%20process%7D%0A"></p>
<p>The processes are indistinguishable for short data records, in the sense that both a trend stationary process (TSP) and a DSP can fit short data records extremely well. However, the processes can be distinguished when restricted to a particular subclass of data-generating processes, such as AR(<img src="https://latex.codecogs.com/png.latex?p">) processes.</p>
<p>Consider the case of an AR(1) process:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AY_t=a_1Y_%7Bt-1%7D+%5Cepsilon_t%0A"></p>
<p>We may be interested in testing the hypothesis <img src="https://latex.codecogs.com/png.latex?a_1=1">. Since under the null hypothesis the sequence <img src="https://latex.codecogs.com/png.latex?%5C%7BY_t%5C%7D"> is generated by a nonstationary process, and the variance becomes infinitely large as <img src="https://latex.codecogs.com/png.latex?t"> increases, classical statistical methods cannot be used.</p>
<p>Dickey and Fuller devised a procedure to formally test for the presence of a unit root against a number of possible alternatives for explaining the data. It is important to recall that TSP and DSP can produce different forecasts and can give rise to spurious regressions, therefore their detection in time series is a truly important task.</p>
</section>
<section id="augmented-dickey-fuller-test" class="level2">
<h2 class="anchored" data-anchor-id="augmented-dickey-fuller-test">Augmented Dickey-Fuller test</h2>
<p>A distinction between stationary and nonstationary time series is made by formal statistical procedures such as the ADF (Augmented Dickey-Fuller) test, which is frequently used since it also accounts for serial correlation in the time series.</p>
<p>Three specifications of the ADF test are based on the following regression equations.</p>
<section id="type-1-unit-root-with-none" class="level4">
<h4 class="anchored" data-anchor-id="type-1-unit-root-with-none">Type 1 (unit root with “none”)</h4>
<p><span id="eq-eq8"><img src="https://latex.codecogs.com/png.latex?%0A%5CDelta%20Y_t=%5Cgamma%20Y_%7Bt-1%7D+%5Cunderbrace%7B%5Csum_%7Bi=2%7D%5Ep%5Cbeta_i%5CDelta%20Y_%7Bt-i+1%7D%7D_%7B%5Ctext%7Bserial%20correlation%7D%7D+%5Cepsilon_t%0A%5Ctag%7B1%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cepsilon_t"> is white Gaussian noise, stationary with zero mean and constant variance. The statistical hypothesis test is:</p>
<p><span id="eq-eq9"><img src="https://latex.codecogs.com/png.latex?%0A(%5Ctau_1)%5Crightarrow%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7DH_0:&amp;%5Cquad%5Cgamma=0%5C%5C%0AH_1:&amp;%5Cquad%5Cgamma%5Cneq%200%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B2%7D"></span></p>
<p>The null hypothesis prescribes the existence of a unit-root in the model. Rejection of the null implies that the original time series <em>does not have a unit root</em>.</p>
</section>
<section id="type-2-unit-root-with-drift" class="level4">
<h4 class="anchored" data-anchor-id="type-2-unit-root-with-drift">Type 2 (unit root with “drift”)</h4>
<p><span id="eq-eq10"><img src="https://latex.codecogs.com/png.latex?%0A%5CDelta%20Y_t=%5Cgamma%20Y_%7Bt-1%7D+%5Cunderbrace%7Ba_0%7D_%7B%5Ctext%7Bdrift%7D%7D+%5Cunderbrace%7B%5Csum_%7Bi=2%7D%5Ep%5Cbeta_i%5CDelta%20Y_%7Bt-i+1%7D%7D_%7B%5Ctext%7Bserial%20correlation%7D%7D+%5Cepsilon_t%0A%5Ctag%7B3%7D"></span></p>
<p>The statistical hypothesis tests are:</p>
<p><span id="eq-eq11"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A&amp;(%5Cphi_1)%5Crightarrow%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7DH_0:&amp;%5Cquad%5Cgamma=0%5C;%5Ctext%7Band%7D%5C;a_0=0%5C%5C%0AH_1:&amp;%5Cquad%5Cgamma%5Cneq%200%5C;%5Ctext%7B%20%20or%7D%5C;%5C;%5C,a_0%5Cneq0%0A%5Cend%7Bsplit%7D%0A%5Cright.%5C%5C%0A&amp;%5C%5C%0A&amp;(%5Ctau_2)%5Crightarrow%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7DH_0:&amp;%5Cquad%5Cgamma=0%5C%5C%0AH_1:&amp;%5Cquad%5Cgamma%5Cneq%200%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Cend%7Bsplit%7D%0A%5Ctag%7B4%7D"></span></p>
</section>
<section id="type-3-unit-root-with-drift-and-trend" class="level4">
<h4 class="anchored" data-anchor-id="type-3-unit-root-with-drift-and-trend">Type 3 (unit root with “drift and trend”)</h4>
<p><span id="eq-eq12"><img src="https://latex.codecogs.com/png.latex?%0A%5CDelta%20Y_t=%5Cgamma%20Y_%7Bt-1%7D+%5Cunderbrace%7Ba_0%7D_%7B%5Ctext%7Bdrift%7D%7D+%5Cunderbrace%7Ba_2t%7D_%7B%5Ctext%7Btrend%7D%7D+%5Cunderbrace%7B%5Csum_%7Bi=2%7D%5Ep%5Cbeta_i%5CDelta%20Y_%7Bt-i+1%7D%7D_%7B%5Ctext%7Bserial%20correlation%7D%7D+%5Cepsilon_t%0A%5Ctag%7B5%7D"></span></p>
<p>The statistical hypothesis tests are:</p>
<p><span id="eq-eq13"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A&amp;(%5Cphi_2)%5Crightarrow%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7DH_0:&amp;%5Cquad%5Cgamma=0%5C;%5Ctext%7Band%7D%5C;a_0=0%5C;%5Ctext%7Band%7D%5C;a_2=0%5C%5C%0AH_1:&amp;%5Cquad%5Cgamma%5Cneq%200%5C;%5Ctext%7B%20%20or%7D%5C;%5C;%5C,a_0%5Cneq0%5C;%5Ctext%7B%20%20or%7D%5C;%5C;%5C,a_2%5Cneq0%5C%5C%0A%5Cend%7Bsplit%7D%0A%5Cright.%5C%5C%0A&amp;%5C%5C%0A&amp;(%5Cphi_3)%5Crightarrow%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7DH_0:&amp;%5Cquad%5Cgamma=0%5C;%5Ctext%7Band%7D%5C;a_2=0%5C%5C%0AH_1:&amp;%5Cquad%5Cgamma%5Cneq%200%5C;%5Ctext%7B%20%20or%7D%5C;%5C;%5C,a_2%5Cneq0%0A%5Cend%7Bsplit%7D%0A%5Cright.%5C%5C%0A&amp;%5C%5C%0A&amp;(%5Ctau_3)%5Crightarrow%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7DH_0:&amp;%5Cquad%5Cgamma=0%5C%5C%0AH_1:&amp;%5Cquad%5Cgamma%5Cneq%200%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Cend%7Bsplit%7D%0A%5Ctag%7B6%7D"></span></p>
<p>Each of the six tests <img src="https://latex.codecogs.com/png.latex?(%5Ctau_1),(%5Ctau_2),(%5Ctau_3),(%5Cphi_1),(%5Cphi_2),(%5Cphi_3)"> in Equation&nbsp;2, Equation&nbsp;4 and Equation&nbsp;6 corresponds to a progressively more complex linear regression. In all of them there is the root, but in the “drift” model there is also a drift term, and in the “drift and trend” model there are also drift and trend terms. All the coefficients in the models have an associated significance level. While the significance of the root coefficient is the most important and the main focus of the ADF test, we might also be interested in knowing whether or not the drift and trend coefficients are statistically significant.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Summary of the Dickey-Fuller tests
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A&amp;%5Cbegin%7Bsplit%7D%0A&amp;%5Ctextbf%7BTrend%7D%5Cquad%5Cquad%5CDelta%20Y_t=%5Cgamma%20Y_%7Bt-1%7D+a_0+a_2t+%5Csum_%7Bi=2%7D%5Ep%5Cbeta_i%5CDelta%20Y_%7Bt-i+1%7D+%5Cepsilon_t%5C%5C%0A&amp;%5Cbegin%7Bsplit%7D%0A&amp;%5Ctext%7Bif%7D%5C;(%5Cphi_2)%5C;%5Ctext%7Bis%20rejected,%20unit%20root%20is%20NOT%20present%20OR%20there%20is%20trend%20OR%20there%20is%20drift%7D%5C%5C%0A&amp;%5Ctext%7Bif%7D%5C;(%5Cphi_2)%5C;%5Ctext%7Bfails%20to%20be%20rejected,%20unit%20root%20is%20present%20AND%20there%20is%20NO%20trend%20AND%20there%20is%20NO%20drift%7D%5C%5C%0A&amp;%5Ctext%7Bif%7D%5C;(%5Cphi_3)%5C;%5Ctext%7Bis%20rejected,%20unit%20root%20is%20NOT%20present%20OR%20there%20is%20trend%7D%5C%5C%0A&amp;%5Ctext%7Bif%7D%5C;(%5Cphi_3)%5C;%5Ctext%7Bfails%20to%20be%20rejected,%20unit%20root%20is%20present%20AND%20there%20is%20NO%20trend%7D%5C%5C%0A&amp;%5Ctext%7Bif%7D%5C;(%5Ctau_3)%5C;%5Ctext%7Bis%20rejected,%20unit%20root%20is%20NOT%20present%7D%5C%5C%0A&amp;%5Ctext%7Bif%7D%5C;(%5Ctau_3)%5C;%5Ctext%7Bfails%20to%20be%20rejected,%20unit%20root%20is%20present%7D%5C%5C%0A&amp;%5Cend%7Bsplit%7D%0A&amp;%5Cend%7Bsplit%7D%5C%5C%0A&amp;%5Cbegin%7Bsplit%7D%0A&amp;%5Ctextbf%7BDrift%7D%5Cquad%5Cquad%5CDelta%20Y_t=%5Cgamma%20Y_%7Bt-1%7D+a_0+%5Csum_%7Bi=2%7D%5Ep%5Cbeta_i%5CDelta%20Y_%7Bt-i+1%7D+%5Cepsilon_t%5C%5C%0A&amp;%5Cbegin%7Bsplit%7D%0A&amp;%5Ctext%7Bif%7D%5C;(%5Cphi_1)%5C;%5Ctext%7Bis%20rejected,%20unit%20root%20is%20NOT%20present%20OR%20there%20is%20drift%7D%5C%5C%0A&amp;%5Ctext%7Bif%7D%5C;(%5Cphi_1)%5C;%5Ctext%7Bfails%20to%20be%20rejected,%20unit%20root%20is%20present%20AND%20there%20is%20NO%20drift%7D%5C%5C%0A&amp;%5Ctext%7Bif%7D%5C;(%5Ctau_2)%5C;%5Ctext%7Bis%20rejected,%20unit%20root%20is%20NOT%20present%7D%5C%5C%0A&amp;%5Ctext%7Bif%7D%5C;(%5Ctau_2)%5C;%5Ctext%7Bfails%20to%20be%20rejected,%20unit%20root%20is%20present%7D%5C%5C%0A&amp;%5Cend%7Bsplit%7D%0A&amp;%5Cend%7Bsplit%7D%5C%5C%0A&amp;%5Cbegin%7Bsplit%7D%0A&amp;%5Ctextbf%7BNone%7D%5Cquad%5Cquad%5CDelta%20Y_t=%5Cgamma%20Y_%7Bt-1%7D+%5Csum_%7Bi=2%7D%5Ep%5Cbeta_i%5CDelta%20Y_%7Bt-i+1%7D+%5Cepsilon_t%5C%5C%0A&amp;%5Cbegin%7Bsplit%7D%0A&amp;%5Ctext%7Bif%7D%5C;(%5Ctau_1)%5C;%5Ctext%7Bis%20rejected,%20unit%20root%20is%20NOT%20present%7D%5C%5C%0A&amp;%5Ctext%7Bif%7D%5C;(%5Ctau_1)%5C;%5Ctext%7Bfails%20to%20be%20rejected,%20unit%20root%20is%20present%7D%0A&amp;%5Cend%7Bsplit%7D%0A&amp;%5Cend%7Bsplit%7D%0A%5Cend%7Bsplit%7D%0A"></p>
</div>
</div>
<p>An important extension of the ADF test concerns the case when the noise error term is not white. If the error term is not white and we run the ADF test as it is without accounting for serial correlation, many more rejection of the null tend to be produced than stated at the specified significance level. As the ADF test also deal with the serial correlation by introducing lagged terms, hence we need to select this lag order. This is accomplished by investigating several information criteria, including the autocorrelation function (ACF), but henceforth I limit to use the automatic lag selection functionality provided by the same function of R I will use for running the ADF test. Recall that, in general, the test statistics of the ADF test are very sensitive to changes in the lag structure.</p>
</section>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<p>I use functions and data from the <code>urca</code> package. The data set contains the series that S. Johansen and K. Juselius considered for estimating the money demand function of Denmark <span class="citation" data-cites="johansen1990">(Johansen and Juselius 1990)</span>. A data frame with quarterly data from Denmark starting in 1974:Q1 until 1987:Q3 contains six variables, including the log real income <code>LRY</code>, whose evolution, together with that of its first difference, is shown in Figure&nbsp;1.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggpubr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(grid)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(urca)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(zoo)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(denmark)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">attach</span>(denmark)</span>
<span id="cb1-9">denmark <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(denmark)</span>
<span id="cb1-10">a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(ENTRY)</span>
<span id="cb1-11">k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(a)</span>
<span id="cb1-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>k) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substring</span>(a[i], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">first =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">last =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-"</span></span>
<span id="cb1-13">ENTRY <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.yearqtr</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(a))</span>
<span id="cb1-14"></span>
<span id="cb1-15">df_ts  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ENTRY, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> LRY)</span>
<span id="cb1-16">df_dts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ENTRY[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>k<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diff</span>(LRY))</span>
<span id="cb1-17"></span>
<span id="cb1-18">my_theme <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb1-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>),</span>
<span id="cb1-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb1-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>),</span>
<span id="cb1-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb1-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb1-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb1-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.border =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-26">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-27">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-28">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-29">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>))</span>
<span id="cb1-30"></span>
<span id="cb1-31">p_ts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_ts, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb1-34">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LRY"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-35">  my_theme</span>
<span id="cb1-36"></span>
<span id="cb1-37">p_dts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_dts, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb1-40">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"first difference, LRY"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-41">  my_theme</span>
<span id="cb1-42"></span>
<span id="cb1-43"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid.newpage</span>()</span>
<span id="cb1-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid.draw</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplotGrob</span>(p_ts), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplotGrob</span>(p_dts), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"last"</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/dickey_fuller/index_files/figure-html/fig-fig1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Time series to be tested for stationarity. On the left, the natural logarithm of real income vs.&nbsp;time; on the right its first difference.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The function <code>ur.df()</code> from the <code>urca</code> package performs the ADF test, with three types of models and related tests, named “none” (i.e., Equation&nbsp;1-Equation&nbsp;2), “drift” (i.e., Equation&nbsp;3-Equation&nbsp;4) and “trend” (Equation&nbsp;5-Equation&nbsp;6). The argument <code>selectlags</code> in <code>ur.df()</code> allows to perform automatic selection of the lag structure according to a predefined criterion, as shown in the following code block.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">mdl_none_ts   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ur.df</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> df_ts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectlags =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BIC"</span>))</span>
<span id="cb2-2">mdl_drift_ts  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ur.df</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> df_ts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drift"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectlags =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BIC"</span>))</span>
<span id="cb2-3">mdl_trend_ts  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ur.df</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> df_ts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trend"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectlags =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BIC"</span>))</span>
<span id="cb2-4">mdl_none_dts  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ur.df</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> df_dts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectlags =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BIC"</span>))</span>
<span id="cb2-5">mdl_drift_dts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ur.df</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> df_dts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drift"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectlags =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BIC"</span>))</span>
<span id="cb2-6">mdl_trend_dts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ur.df</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> df_dts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trend"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectlags =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BIC"</span>))</span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(mdl_trend_ts)</span></code></pre></div>
</details>
</div>
<p>The summary produced when the ADF test is applied to the original time series with the type “trend” is shown in Figure&nbsp;2.</p>
<div id="fig-fig2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/dickey_fuller/summary.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Results of fitting the “trend” regression model in the ADF test when applied to the `LRY`variable from the `denmark` dataset.
</figcaption>
</figure>
</div>
<p>The part of interest for the analysis is within the rectangle highlighted in orange. The “Value of test-statistic is -2.4216 2.1927 2.9343” for tests <img src="https://latex.codecogs.com/png.latex?(%5Ctau_3),%20(%5Cphi_2)"> and <img src="https://latex.codecogs.com/png.latex?(%5Cphi_3)"> are given and the corresponding “Critical values for test statistics” at significance levels 1%, 5% and 10% are reported below, denoted by <code>tau3</code>, <code>phi2</code> and <code>phi3</code>, respectively. For instance, for the test <img src="https://latex.codecogs.com/png.latex?(%5Ctau_3)">, given that the test statistic -2.4216 is within the three regions -4.04, -3.45, -3.15 (1%, 5%, 10%) where we fail to reject the null, we do not have evidence to reject the presence of a unit root in the regression model: we can say that there is a unit root. From the <img src="https://latex.codecogs.com/png.latex?(%5Cphi_2)">-statistic, the joint null hypothesis is not rejected, therefore there is a unit root AND drift and trend terms are not needed. Similarly, the <img src="https://latex.codecogs.com/png.latex?(%5Cphi_3)">-statistic shows that there is a unit root AND a trend term is not needed and the <img src="https://latex.codecogs.com/png.latex?(%5Ctau_3)">-statistic shows that there is a unit root. A summary of test results for the variable <code>LRY</code> is reported within the rectangle highlighted in blue in Figure&nbsp;3.</p>
<div id="fig-fig3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/dickey_fuller/summary_1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Results of the three type of ADF tests for the variable `LRY`from the `denmark`dataset.
</figcaption>
</figure>
</div>
<p>A close examination of Figure&nbsp;3 shows that all the tests applied to data of the variable <code>LRY</code> are consistent with failing to reject the corresponding nulls. From the <img src="https://latex.codecogs.com/png.latex?(%5Cphi_1)">-statistic, the joint null hypothesis is not rejected, therefore there is a unit root AND the drift term is not needed, and the <img src="https://latex.codecogs.com/png.latex?(%5Ctau_2)">-statistic shows that there is a unit root. Finally, the <img src="https://latex.codecogs.com/png.latex?(%5Ctau_1)">-statistic also shows that there is a unit root.</p>
<p>On the other hand, all the tests applied to the first difference of the variable <code>LRY</code> reject the corresponding nulls, as shown in the same Figure&nbsp;3 (summary within the rectangle highlighted in red): although drift and trend terms might be presumed, this variable does not therefore contain a unit root.</p>
<blockquote class="blockquote">
<p>Finally, we can conclude that the logarithm of real income contains a unit root and can be a stationary time series by taking the first difference.</p>
</blockquote>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-johansen1990" class="csl-entry">
Johansen, Søren, and Katarina Juselius. 1990. <span>“Maximum Likelihood Estimation and Inference on Cointegration <span></span> with Applications to the Demand for Money.”</span> <em>Oxford Bulletin of Economics and Statistics</em> 52 (2): 169–210. <a href="https://doi.org/10.1111/j.1468-0084.1990.mp52002003.x">https://doi.org/10.1111/j.1468-0084.1990.mp52002003.x</a>.
</div>
</div></section></div> ]]></description>
  <category>time series</category>
  <guid>https://amsabatini.netlify.app/posts/dickey_fuller/</guid>
  <pubDate>Sun, 12 May 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Gambler’s ruin</title>
  <dc:creator>Angelo Maria Sabatini</dc:creator>
  <link>https://amsabatini.netlify.app/posts/gambler/</link>
  <description><![CDATA[ 




<section id="problem" class="level2">
<h2 class="anchored" data-anchor-id="problem">Problem</h2>
<p>The gambler’s ruin problem, first mentioned by <a href="https://en.wikipedia.org/wiki/Blaise_Pascal">Blaise Pascal</a> in one of his letters to <a href="https://en.wikipedia.org/wiki/Pierre_de_Fermat">Pierre Fermat</a>, was then reformulated by <a href="https://en.wikipedia.org/wiki/Christiaan_Huygens">Christiaan Huygens</a>, leading to important advances in the mathematical theory of probability. The statement of the problem considered here is slightly different from the one described by either Pascal or Huygens <span class="citation" data-cites="noauthororeditor">(Bertsekas and Tsitsiklis 2008)</span>.</p>
<blockquote class="blockquote">
<p>Consider a gambler who starts with an initial wealth of €<img src="https://latex.codecogs.com/png.latex?k"> and then on each successive bet either wins €1 or loses €1 with probabilities <img src="https://latex.codecogs.com/png.latex?p"> and <img src="https://latex.codecogs.com/png.latex?q=1%E2%88%92p"> respectively. Different bets are assumed independent. The gambler’s objective is to reach a total wealth of €<img src="https://latex.codecogs.com/png.latex?n"> (<img src="https://latex.codecogs.com/png.latex?n%3Ek">). If the gambler succeeds, then the gambler is said to win the game. The gambler stops playing after winning or getting ruined (running out of money), whichever happens first.</p>
</blockquote>
<p>Calculate the probability that the gambler wins. In particular, which is the probability of the gambler becoming infinitely rich?</p>
</section>
<section id="solution" class="level2">
<h2 class="anchored" data-anchor-id="solution">Solution</h2>
<p>Let us denote by <img src="https://latex.codecogs.com/png.latex?A"> the event that the gambler ends up with €<img src="https://latex.codecogs.com/png.latex?n"> and by <img src="https://latex.codecogs.com/png.latex?F"> the event that the gambler wins the first bet. The probability of the event <img src="https://latex.codecogs.com/png.latex?A"> given that the gambler starts with €<img src="https://latex.codecogs.com/png.latex?k"> is written <img src="https://latex.codecogs.com/png.latex?w_k">. The total probability law allows us to write:</p>
<p><span id="eq-eq1"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0Aw_k&amp;=P(A%5C,%5Cvert%5C,F)P(F)+P(A%5C,%5Cvert%5C,%5Coverline%7BF%7D)P(%5Coverline%7BF%7D)%5C%5C%0A&amp;=pP(A%5C,%5Cvert%5C,F)+(1-p)P(A%5C,%5Cvert%5C,%5Coverline%7BF%7D)%0A%5Cend%7Bsplit%7D%0A%5Ctag%7B1%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D"> is the complement of <img src="https://latex.codecogs.com/png.latex?F">, namely the event <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D"> is that the gambler loses the first bet.</p>
<p>Now, the event <img src="https://latex.codecogs.com/png.latex?A%5C,%5Cvert%5C,F"> is the event <img src="https://latex.codecogs.com/png.latex?A"> given that the gambler starts with €<img src="https://latex.codecogs.com/png.latex?(k+1)">, whose probability is <img src="https://latex.codecogs.com/png.latex?w_%7Bk+1%7D"> (because of the independence from the past). The event <img src="https://latex.codecogs.com/png.latex?A%5C,%5Cvert%5C,%5Coverline%7BF%7D"> is the event <img src="https://latex.codecogs.com/png.latex?A"> given that the gambler starts with €<img src="https://latex.codecogs.com/png.latex?(k-1)">, whose probability is <img src="https://latex.codecogs.com/png.latex?w_%7Bk-1%7D"> (because of the independence from the past). Equation&nbsp;1 reads:</p>
<p><span id="eq-eq10"><img src="https://latex.codecogs.com/png.latex?%0Aw_k=p%5C,w_%7Bk+1%7D+(1-p)%5C,w_%7Bk-1%7D%0A%5Ctag%7B2%7D"></span></p>
<p>If we define <img src="https://latex.codecogs.com/png.latex?r=(1-p)/p">, we can also write:</p>
<p><span id="eq-eq2"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0A&amp;w_%7Bk+1%7D-w_k=r(w_k-w_%7Bk-1%7D),%5C;0%3Ck%3Cn%5C%5C%0A&amp;w_0=0%5C%5C%0A&amp;w_n=1%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B3%7D"></span></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?w_%7Bk+1%7D=w_k+r%5Ek(w_1-w_0)=w_k+r%5Ekw_1=w_1%5Csum_%7Bi=0%7D%5Ekr%5Ei">, we can calculate <img src="https://latex.codecogs.com/png.latex?w_k"> as follows:</p>
<p><span id="eq-eq3"><img src="https://latex.codecogs.com/png.latex?%0Aw_k=%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0A&amp;%5Cfrac%7B1-r%5Ek%7D%7B1-r%7Dw_1&amp;%5Cquad%5Ctext%7Bif%7D%5C;r%5Cneq1%5C%5C%0A&amp;kw_1&amp;%5Cquad%5Ctext%7Bif%7D%5C;r=1%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B4%7D"></span></p>
<p>We also know that <img src="https://latex.codecogs.com/png.latex?w_n=1">. Therefore, we can solve Equation&nbsp;4 for <img src="https://latex.codecogs.com/png.latex?w_1">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aw_1=%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0A&amp;%5Cfrac%7B1-r%7D%7B1-r%5En%7D&amp;%5Cquad%5Ctext%7Bif%7D%5C;r%5Cneq1%5C%5C%0A&amp;%5Cfrac%7B1%7D%7Bn%7D&amp;%5Cquad%5Ctext%7Bif%7D%5C;r=1%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A"></p>
<p>Plugging this expression of <img src="https://latex.codecogs.com/png.latex?w_1"> into Equation&nbsp;4, we obtain:</p>
<p><span id="eq-eq4"><img src="https://latex.codecogs.com/png.latex?%0A%5Cboxed%7Bw_k=%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0A&amp;%5Cfrac%7B1-r%5Ek%7D%7B1-r%5En%7D&amp;%5Cquad%5Ctext%7Bif%7D%5C;r%5Cneq1%5C%5C%0A&amp;%5Cfrac%7Bk%7D%7Bn%7D&amp;%5Cquad%5Ctext%7Bif%7D%5C;r=1%0A%5Cend%7Bsplit%7D%0A%5Cright.%7D%0A%5Ctag%7B5%7D"></span></p>
<p>The probability that the gambler becomes infinitely rich (event <img src="https://latex.codecogs.com/png.latex?R">) is written:</p>
<p><span id="eq-eq5"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0A%5Ctext%7BPr%7D(R)&amp;=%5Clim_%7Bn%5Crightarrow%5Cinfty%7Dw_k=1-%5Cleft(%5Cfrac%7B1-p%7D%7Bp%7D%5Cright)%5Ek%3E0,&amp;%5Cquad%20p%3E1/2%5C;(r%3C1)%5C%5C%0A%5Ctext%7BPr%7D(R)&amp;=%5Clim_%7Bn%5Crightarrow%5Cinfty%7Dw_k=0,&amp;%5Cquad%20p%5Cleq1/2%5C;(r%5Cgeq1)%5C%5C%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B6%7D"></span></p>
<p>To interpret the meaning of Equation&nbsp;6, suppose that the gambler starting with an initial wealth of €<img src="https://latex.codecogs.com/png.latex?k"> wishes to continue gambling, with the intention of earning as much money as possible. So there is no winning value €<img src="https://latex.codecogs.com/png.latex?n">: the gambler will only stop if ruined. If <img src="https://latex.codecogs.com/png.latex?p%3E1/2"> (each gamble is in favor of the gambler), then there is a positive probability that the gambler will never get ruined but instead will become infinitely rich. Conversely, if <img src="https://latex.codecogs.com/png.latex?p%5Cleq0.5"> (each gamble is not in favor of the gambler), then the gambler will get ruined with probability one.</p>
</section>
<section id="markov-chain-model" class="level2">
<h2 class="anchored" data-anchor-id="markov-chain-model">Markov chain model</h2>
<p>The discrete-state discrete-time Markov chain show in Figure&nbsp;1 can be proposed to model the gambler process <span class="citation" data-cites="noauthororeditor">(Bertsekas and Tsitsiklis 2008)</span>. The <img src="https://latex.codecogs.com/png.latex?n+1"> states, numbered from 0 to <img src="https://latex.codecogs.com/png.latex?n">, represent the gambler’s wealth at the start of each bet. The first state 0 corresponds to ruin (getting out of money), the last state <img src="https://latex.codecogs.com/png.latex?n"> corresponds to win. Given the rules of the game, the states 0 and <img src="https://latex.codecogs.com/png.latex?n"> are absorbing, in the sense that it is not possible to escape from each of them anymore, once they are entered. All the other states are transient.</p>
<div id="fig-fig1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/gambler/markov_chain.png" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Transition probability graph for the gambler’s ruin problem.
</figcaption>
</figure>
</div>
<p>The problem is then to find the probabilities of absorption at each one of the two absorbing states. These absorption probabilities depend on the initial state <img src="https://latex.codecogs.com/png.latex?k%5C;(0%3Ck%3Cn)">. It is worthy noting that the memoryless character of the process implies that, if the gambler happens to revisit the initial state <img src="https://latex.codecogs.com/png.latex?k"> after a while, the absorption probabilities are the same they were initially.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Transition probability matrix
</div>
</div>
<div class="callout-body-container callout-body">
<p>The state of a discrete-state discrete-time Markov chain is denoted by <img src="https://latex.codecogs.com/png.latex?X_t">, that can change at certain discrete time instants <img src="https://latex.codecogs.com/png.latex?n">. The state space of the chain is composed of a finite set <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%7BS%7D=%5C%7B1,%5Ccdots,m%5C%7D">. The Markov chain is described in terms of its transition probability <img src="https://latex.codecogs.com/png.latex?p_%7Bij%7D">:</p>
<p><span id="eq-eq6"><img src="https://latex.codecogs.com/png.latex?%0Ap_%7Bij%7D=P(X_%7Bt+1%7D=j%5C,%5Cvert%5C,X_t=i),%5Cquad%20i,j%5Cin%5Cmathscr%7BS%7D%0A%5Ctag%7B7%7D"></span></p>
<p>The key assumption underlying Markov chains is that the <strong>Markov property</strong> holds:</p>
<p><span id="eq-eq7"><img src="https://latex.codecogs.com/png.latex?%0AP(X_%7Bt+1%7D=j%5C,%5Cvert%5C,X_t=i,X_%7Bt-1%7D=i_%7Bt-1%7D,%5Ccdots,X_0=i_0)=P(X_%7Bt+1%7D=j%20%5C,%5Cvert%5C,X_t=i)=p_%7Bij%7D%0A%5Ctag%7B8%7D"></span></p>
<p>for all times <img src="https://latex.codecogs.com/png.latex?t">, all states <img src="https://latex.codecogs.com/png.latex?i,j%5Cin%5Cmathscr%7BS%7D"> and all possible sequences <img src="https://latex.codecogs.com/png.latex?i_0,i_1,%5Ccdots,i_%7Bt-1%7D"> of earlier states. Thus, the probability law of the next state <img src="https://latex.codecogs.com/png.latex?X_%7Bt+1%7D"> depends on the past only through the value of the present state <img src="https://latex.codecogs.com/png.latex?X_t">.</p>
<p>All of the elements of a Markov chain model can be encoded in a <strong>transition probability matrix</strong>, which is simply a two-dimensional array whose elements at the <img src="https://latex.codecogs.com/png.latex?i">th row and <img src="https://latex.codecogs.com/png.latex?j">th column is <img src="https://latex.codecogs.com/png.latex?P_%7Bij%7D">:</p>
<p><span id="eq-eq8"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0Ap_%7B11%7D&amp;p_%7B12%7D&amp;%5Ccdots&amp;p_%7B1m%7D%5C%5C%0Ap_%7B21%7D&amp;p_%7B22%7D&amp;%5Ccdots&amp;p_%7B2m%7D%5C%5C%0A%5Cvdots&amp;%5Cvdots&amp;%5Cvdots&amp;%5Cvdots%5C%5C%0Ap_%7Bm1%7D&amp;p_%7Bm2%7D&amp;%5Ccdots&amp;p_%7Bmm%7D%0A%5Cend%7Bbmatrix%7D%0A%5Ctag%7B9%7D"></span></p>
<p>Consider a Markov chain in which each state is either transient or absorbing. We fix a particular absorbing state <img src="https://latex.codecogs.com/png.latex?s">. It is possible to show that the probabilities <img src="https://latex.codecogs.com/png.latex?w_k"> of eventually reaching state <img src="https://latex.codecogs.com/png.latex?s">, starting from <img src="https://latex.codecogs.com/png.latex?k">, are the unique solution of the equations <img src="https://latex.codecogs.com/png.latex?w_s=1,%20w_i=0">, for all absorbing <img src="https://latex.codecogs.com/png.latex?i%5Cneq%20s">, and for all transient <img src="https://latex.codecogs.com/png.latex?i">:</p>
<p><span id="eq-eq9"><img src="https://latex.codecogs.com/png.latex?%0Aw_i=%5Csum_%7Bj=1%7D%5Emp_%7Bij%7Dw_j%0A%5Ctag%7B10%7D"></span></p>
</div>
</div>
<div id="exm-exm1" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (Gambler’s discrete-time Markov chain)</strong></span> For <img src="https://latex.codecogs.com/png.latex?n=4,p,q=1-p"> the transition probability matrix of the gambler’s discrete-time Markov chain is given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0A1&amp;0&amp;0&amp;0&amp;0%5C%5C%0Aq&amp;0&amp;p&amp;0&amp;0%5C%5C%0A0&amp;q&amp;0&amp;p&amp;0%5C%5C%0A0&amp;0&amp;q&amp;0&amp;p%5C%5C%0A0&amp;0&amp;0&amp;0&amp;1%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>In the case of the gambler’s ruin problem, Equation&nbsp;10 can be reformulated as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aw_k=(1-p)%5C,w_%7Bk-1%7D+p%5C,w_%7Bk+1%7D%0A"></p>
<p>with <img src="https://latex.codecogs.com/png.latex?w_0=0,w_n=1">, leading to Equation&nbsp;2.</p>
</div>
</section>
<section id="simulation" class="level2">
<h2 class="anchored" data-anchor-id="simulation">Simulation</h2>
<p>The following code written in R simulates the gambler process (adapted from <span class="citation" data-cites="dobrow2016">(Dobrow 2016)</span>).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2001</span>)</span>
<span id="cb1-2">gambler <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(k, n, p) {</span>
<span id="cb1-3">  stake <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> k</span>
<span id="cb1-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> (stake <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> stake <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> n) {</span>
<span id="cb1-5">        bet <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p, p))</span>
<span id="cb1-6">        stake <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> stake <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bet</span>
<span id="cb1-7">    }</span>
<span id="cb1-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (stake <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> n) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-9">}   </span>
<span id="cb1-10">k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initial wealth</span></span>
<span id="cb1-11">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># final wealth</span></span>
<span id="cb1-12">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># probability of win at each bet</span></span>
<span id="cb1-13">ntrials <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of independent trials</span></span>
<span id="cb1-14"></span>
<span id="cb1-15">sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(ntrials, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gambler</span>(k, n, p))</span>
<span id="cb1-16">p_ruin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(sim)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>ntrials </span></code></pre></div>
</details>
</div>
<p>The probability of ruin estimated over 1000 iterations of the gambler process is 0.888, in close agreement with the value 0.875 computed from Equation&nbsp;5.</p>
<p>It is noted that, at each time step, the gambler appears to move randomly, either to the left or to the right by a fixed unit distance with probability <img src="https://latex.codecogs.com/png.latex?p"> and <img src="https://latex.codecogs.com/png.latex?1-p">, respectively. The gambler undergoes a simple random walk in one dimension, whose state space is the set of the integers <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D">. The limitations to values of <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D"> between 0 (ruin) and <img src="https://latex.codecogs.com/png.latex?n"> (win) are the consequence of the gambling rules: these rules settle two absorbing barriers to the motion of the random walker. Nine exemplary sample paths of the random walk are shown in Figure&nbsp;2, for the case that <img src="https://latex.codecogs.com/png.latex?k=30,n=120,p=0.5">.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggpubr)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2001</span>)</span>
<span id="cb2-5">k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initial wealth</span></span>
<span id="cb2-6">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># final wealth</span></span>
<span id="cb2-7">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># probability of win at each bet</span></span>
<span id="cb2-8">ntrials <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of independent trials</span></span>
<span id="cb2-9">nstep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of steps</span></span>
<span id="cb2-10">traj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> nstep, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> ntrials)</span>
<span id="cb2-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>ntrials) {</span>
<span id="cb2-12">  traj[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> k</span>
<span id="cb2-13">  jmax <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nstep</span>
<span id="cb2-14">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>nstep) {</span>
<span id="cb2-15">          bet <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p, p))</span>
<span id="cb2-16">          traj[j, i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> traj[j<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>, i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bet</span>
<span id="cb2-17">          <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (traj[j, i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> traj[j, i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> n) {</span>
<span id="cb2-18">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb2-19">          }</span>
<span id="cb2-20">  }</span>
<span id="cb2-21">}   </span>
<span id="cb2-22">t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, nstep<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), ntrials)</span>
<span id="cb2-23">path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"7"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"8"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"9"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> nstep)</span>
<span id="cb2-24">traj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(traj)</span>
<span id="cb2-25">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> t, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> path, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> traj)</span>
<span id="cb2-26"></span>
<span id="cb2-27">my_theme <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb2-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb2-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb2-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb2-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb2-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb2-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.border =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>),</span>
<span id="cb2-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>))</span>
<span id="cb2-40"></span>
<span id="cb2-41"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> t, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> path)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bets"</span>,</span>
<span id="cb2-44">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gambler's wealth"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>path, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label_both"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-49">  my_theme</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/gambler/index_files/figure-html/fig-fig2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Gambler’s random walk: nine sample paths. The outcome of up to a maximum of 1000 bets is considered here.
</figcaption>
</figure>
</div>
</div>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-noauthororeditor" class="csl-entry">
Bertsekas, Dimitri P., and John N. Tsitsiklis. 2008. <span>“Introduction to Probability.”</span> <a href="https://ocw.mit.edu/resources/res-6-012-introduction-to-probability-spring-2018/part-i-the-fundamentals/MITRES_6_012S18_Textbook.pdf">https://ocw.mit.edu/resources/res-6-012-introduction-to-probability-spring-2018/part-i-the-fundamentals/MITRES_6_012S18_Textbook.pdf</a>.
</div>
<div id="ref-dobrow2016" class="csl-entry">
Dobrow, Robert P. 2016. <span>“Introduction to Stochastic Processes with r,”</span> March. <a href="https://doi.org/10.1002/9781118740712">https://doi.org/10.1002/9781118740712</a>.
</div>
</div></section></div> ]]></description>
  <category>probability</category>
  <guid>https://amsabatini.netlify.app/posts/gambler/</guid>
  <pubDate>Sat, 04 May 2024 22:00:00 GMT</pubDate>
  <media:content url="https://amsabatini.netlify.app/posts/gambler/ruin.png" medium="image" type="image/png" height="117" width="144"/>
</item>
<item>
  <title>Multivariate probability regions</title>
  <dc:creator>Angelo Maria Sabatini</dc:creator>
  <link>https://amsabatini.netlify.app/posts/multivariate_probability_regions/</link>
  <description><![CDATA[ 




<section id="prediction-hyperellipsoid" class="level2">
<h2 class="anchored" data-anchor-id="prediction-hyperellipsoid">Prediction hyperellipsoid</h2>
<p>Consider the case of a multivariate random variable <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BX%7D%5Cin%5Cmathbb%7BR%7D%5Ed">, whose distribution is normal with mean value <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7B%5Cmu%7D"> and covariance matrix <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BC%7D">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbf%7BC%7D=%5Cbegin%7Bbmatrix%7D%5Csigma_1%5E2&amp;%5Ccdots&amp;%5Csigma_%7B1d%7D%5C%5C%5Cvdots&amp;%5Cddots&amp;%5Cvdots%5C%5C%5Csigma_%7Bd1%7D&amp;%5Ccdots&amp;%5Csigma%5E2_d%5Cend%7Bbmatrix%7D%0A"></p>
<p>from which we draw a sample of <img src="https://latex.codecogs.com/png.latex?n"> data points:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbf%7Bx%7D_i=%5Cbegin%7Bbmatrix%7Dx_%7Bi1%7D%5C%5C%5Cvdots%5C%5Cx_%7Bid%7D%5Cend%7Bbmatrix%7D%0A"></p>
<p>We suppose that either the mean value or the covariance matrix are unknown; they can be estimated using the <strong>sample mean</strong>, denoted by <img src="https://latex.codecogs.com/png.latex?%5Cbar%7B%5Cmathbf%7Bx%7D%7D">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%7B%5Cmathbf%7Bx%7D%7D=%5Cbegin%7Bbmatrix%7D%5Cbar%7Bx%7D_1%5C%5C%5Cvdots%5C%5C%5Cbar%7Bx%7D_d%5Cend%7Bbmatrix%7D=%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi=1%7D%5En%5Cbegin%7Bbmatrix%7Dx_%7Bi1%7D%5C%5C%5Cvdots%5C%5Cx_%7Bid%7D%5Cend%7Bbmatrix%7D=%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi=1%7D%5En%5Cmathbf%7Bx%7D_i%0A"></p>
<p>and the <strong>sample covariance matrix</strong>, denoted by <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7B%5CSigma%7D">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbf%7B%5CSigma%7D=%5C%7B%5C,%5Csigma_%7Bjk%7D,j,k=1,%5Ccdots%20d%5C,%5C%7D=%5Cfrac%7B1%7D%7Bn-1%7D%5Csum_%7Bi=1%7D%5En(%5Cmathbf%7Bx%7D_i-%5Cbar%7B%5Cmathbf%7Bx%7D%7D)(%5Cmathbf%7Bx%7D_i-%5Cbar%7B%5Cmathbf%7Bx%7D%7D)%5ET%0A"></p>
<p>whose <img src="https://latex.codecogs.com/png.latex?jk">th element is written:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5CSigma_%7Bjk%7D=%5Cfrac%7B1%7D%7Bn-1%7D%5Csum_%7Bi=1%7D%5En(x_%7Bij%7D-%5Cbar%7Bx%7D_j)(x_%7Bik%7D-%5Cbar%7Bx%7D_k)%0A"></p>
<p>The <img src="https://latex.codecogs.com/png.latex?95%5C%25"> prediction interval is a <img src="https://latex.codecogs.com/png.latex?d">-dimensional <strong>prediction hyperellipsoid</strong>, which, formally, is written as follows:</p>
<p><span id="eq-eq1"><img src="https://latex.codecogs.com/png.latex?%0A%5Cboxed%7B(%5Cmathbf%7Bx%7D_%7B%5Ctext%7Bnew%7D%7D-%5Cbar%7B%5Cmathbf%7Bx%7D%7D)%5ET%5Cmathbf%7B%5CSigma%7D%5E%7B-1%7D(%5Cmathbf%7Bx%7D_%7B%5Ctext%7Bnew%7D%7D-%5Cbar%7B%5Cmathbf%7Bx%7D%7D)%5Cleq%20F_%7B0.95,d,n-d%7D%5Cfrac%7B(n-1)(n+1)%7D%7Bn(n-d)%7Dd%7D%0A%5Ctag%7B1%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D_%7B%5Ctext%7Bnew%7D%7D"> is the new observation for which the prediction interval is desired. <img src="https://latex.codecogs.com/png.latex?F_%7B0.95,n,n-d%7D"> is the quantile with probability 0.95 of the Fisher’s <img src="https://latex.codecogs.com/png.latex?F">-distribution with <img src="https://latex.codecogs.com/png.latex?d"> and <img src="https://latex.codecogs.com/png.latex?(n-d)"> degrees of freedom.</p>
<p>Equation&nbsp;1 is the formula for predicting the next single observation where we only have estimates of the mean value and the covariance matrix from the sample.</p>
<p>Another interesting formula can be elaborated as for the computation of the volume of the prediction hyperellipsoid. Recall that the prediction hyperellipsoid is the transformation of the hypersphere of radius</p>
<p><span id="eq-eq7"><img src="https://latex.codecogs.com/png.latex?%0Ar=%5Csqrt%7BF_%7B0.95,d,n-d%7D%5Cfrac%7B(n-1)(n+1)%7D%7Bn(n-d)%7Dd%7D%0A%5Ctag%7B2%7D"></span></p>
<p>by the linear transform of matrix <img src="https://latex.codecogs.com/png.latex?%5CSigma%5E%7B1/2%7D">. Let <img src="https://latex.codecogs.com/png.latex?V"> the volume of the hypersphere of radius <img src="https://latex.codecogs.com/png.latex?r"> in an <img src="https://latex.codecogs.com/png.latex?d">-dimensional space. The volume of the hyperellipsoid can be obtained from <img src="https://latex.codecogs.com/png.latex?V"> by multiplying with the determinant of the linear transform:</p>
<p><span id="eq-eq6"><img src="https://latex.codecogs.com/png.latex?%0AV_d=%5Cunderbrace%7B%5Cfrac%7B2%7D%7Bd%7D%5Cfrac%7B%5Cpi%5E%7Bd/2%7D%7D%7B%5CGamma(d/2)%7Dr%5Ed%7D_%7BV%7D%5Csqrt%7B%5Cdet(%5CSigma)%7D%0A%5Ctag%7B3%7D"></span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Univariate and bivariate random variables
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Univariate random variable</strong></p>
<p>When <img src="https://latex.codecogs.com/png.latex?d=1">, Equation&nbsp;1 reads:</p>
<p><span id="eq-eq2"><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cvert%5C,x_%7B%5Ctext%7Bnew%7D%7D-%5Cbar%7Bx%7D%5C,%5Cvert%7D%7Bs%7D%5Cleq%5Csqrt%7BF_%7B0.95,1,n-1%7D%5E%7B%5Cphantom%7B'%7D%7D%7D%5Csqrt%7B1+%5Cfrac%7B1%7D%7Bn%7D%5E%7B%5Cphantom%7B'%7D%7D%7D%0A%5Ctag%7B4%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?s"> is the sample standard deviation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0As=%5Csqrt%7B%5Cfrac%7B1%7D%7Bn-1%7D%5Csum_%7Bi=1%7D%5En(x_i-%5Cbar%7Bx%7D)%5E2%7D%0A"></p>
<p>It is noted that</p>
<p><span id="eq-eq8"><img src="https://latex.codecogs.com/png.latex?%0AF_%7B0.95,1,n-1%7D=t_%7B0.975,n-1%7D%5E2%0A%5Ctag%7B5%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?t_%7B0.975,n-1%7D"> is the quantile with probability 0.975 of the <img src="https://latex.codecogs.com/png.latex?t">-Student distribution with <img src="https://latex.codecogs.com/png.latex?n-1"> degrees of freedom. Therefore Equation&nbsp;4 can be written:</p>
<p><span id="eq-eq3"><img src="https://latex.codecogs.com/png.latex?%0A%5Cvert%5C,x_%7B%5Ctext%7Bnew%7D%7D-%5Cbar%7Bx%7D%5C,%5Cvert%5Cleq%20t_%7B0.975,n-1%7Ds%5Csqrt%7B1+%5Cfrac%7B1%7D%7Bn%7D%5E%7B%5Cphantom%7B'%7D%7D%7D%0A%5Ctag%7B6%7D"></span></p>
<p>For large <img src="https://latex.codecogs.com/png.latex?n">, when the central limit theorem can be applied, Equation&nbsp;6 can be simplified:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cboxed%7B%5Cvert%5C,x_%7B%5Ctext%7Bnew%7D%7D-%5Cbar%7Bx%7D%5C,%5Cvert%5Cleq%20z_%7B0.975%7Ds%7D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?z_%7B0.975%7D=1.96"> is the quantile with probability 0.975 of the standard normal distribution.</p>
<p><strong>Bivariate random variable</strong></p>
<p>When <img src="https://latex.codecogs.com/png.latex?d=2">, Equation&nbsp;1 reads:</p>
<p><span id="eq-eq4"><img src="https://latex.codecogs.com/png.latex?%0A(%5Cmathbf%7Bx%7D_%7B%5Ctext%7Bnew%7D%7D-%5Cbar%7B%5Cmathbf%7Bx%7D%7D)%5ET%5Cmathbf%7B%5CSigma%7D%5E%7B-1%7D(%5Cmathbf%7Bx%7D_%7B%5Ctext%7Bnew%7D%7D-%5Cbar%7B%5Cmathbf%7Bx%7D%7D)%5Cleq2F_%7B0.95,2,n-2%7D%5Cfrac%7B(n-1)(n+1)%7D%7Bn(n-2)%7D%0A%5Ctag%7B7%7D"></span></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?2F_%7B0.95,2,%5Cinfty%7D=%5Cchi%5E2(2)">, for large <img src="https://latex.codecogs.com/png.latex?n"> we can simplity Equation&nbsp;7 as follows:</p>
<p><span id="eq-eq5"><img src="https://latex.codecogs.com/png.latex?%0A%5Cboxed%7B(%5Cmathbf%7Bx%7D_%7B%5Ctext%7Bnew%7D%7D-%5Cbar%7B%5Cmathbf%7Bx%7D%7D)%5ET%5Cmathbf%7B%5CSigma%7D%5E%7B-1%7D(%5Cmathbf%7Bx%7D_%7B%5Ctext%7Bnew%7D%7D-%5Cbar%7B%5Cmathbf%7Bx%7D%7D)%5Cleq%5Cchi%5E2(0.95,2)%7D%0A%5Ctag%7B8%7D"></span></p>
</div>
</div>
</section>
<section id="concentration-ellipse" class="level2">
<h2 class="anchored" data-anchor-id="concentration-ellipse">Concentration ellipse</h2>
<p>Equation&nbsp;8 is the equation of the <img src="https://latex.codecogs.com/png.latex?95%5C%25"> prediction ellipse for a bivariate normal distribution, whose sample mean value and sample covariance matrix are calculated from a large-size dataset. The ellipse is also called the <strong>concentration ellipse</strong>. Using Equation&nbsp;5 the area <img src="https://latex.codecogs.com/png.latex?A=V_2"> of the concentration ellipse can be computed from Equation&nbsp;2-Equation&nbsp;3 when <img src="https://latex.codecogs.com/png.latex?n"> is large as follows:</p>
<p><span id="eq-eq9"><img src="https://latex.codecogs.com/png.latex?%0A%5Cboxed%7BA=%5Cpi%5Csqrt%7B%5Cdet(%5CSigma)%7D%5C,%5Cchi%5E2_%7B0.95,2%7D%7D%0A%5Ctag%7B9%7D"></span></p>
<div id="exm-exm1" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (Simulation)</strong></span> The dataset is composed of 1000 points simulated from a bivariate normal distribution with mean value and covariance matrix:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbf%7B%5Cmu%7D=%5Cbegin%7Bbmatrix%7D1%5C%5C2%5Cend%7Bbmatrix%7D%5Cquad%5Cmathbf%7BC%7D=%5Cbegin%7Bbmatrix%7D5&amp;2%5C%5C2&amp;4%5Cend%7Bbmatrix%7D%0A"></p>
<p>I used the function <a href="https://rdrr.io/cran/splus2R/man/rmvnorm.html"><code>rmvnorm()</code></a> from the package <code>rvnorm</code> for the simulation of the dataset, and the function <a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html"><code>stat_ellipse()</code></a> of <code>ggplot2</code> for drawing the ellipse, Figure&nbsp;1. Using <code>stat_ellipse()</code> dispensed me from computing eigenvalues and eigenvectors of the sample covariance matrix, which are needed to evaluate the orientation and the eccentricity of the ellipse in the Cartesian plane. This computation can be based on a simple principal component analysis (PCA).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mvtnorm)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1492</span>)</span>
<span id="cb1-5">sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-6">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb1-7">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rmvnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> sigma)</span>
<span id="cb1-8"></span>
<span id="cb1-9">dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qchisq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to define the 95% probability contour</span></span>
<span id="cb1-10">m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) </span>
<span id="cb1-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) m[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x[, i])    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample mean value</span></span>
<span id="cb1-12">C <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cov</span>(x)                            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample covariance matrix</span></span>
<span id="cb1-13">S <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">solve</span>(C)                          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inverse of C</span></span>
<span id="cb1-14">Q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n)                        </span>
<span id="cb1-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n) Q[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(x[i, ] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> m) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> S <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> (x[i, ] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> m) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># computation of the quadratic form</span></span>
<span id="cb1-16"></span>
<span id="cb1-17">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(x, Q)</span>
<span id="cb1-18">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inside =</span> Q <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> dist)</span>
<span id="cb1-20">aest <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>inside)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># estimated coverage</span></span>
<span id="cb1-21">area <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>dist<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">det</span>(C)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># area of the concentration ellipse </span></span>
<span id="cb1-22"></span>
<span id="cb1-23">my_theme <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb1-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>),</span>
<span id="cb1-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb1-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>),</span>
<span id="cb1-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb1-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb1-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb1-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.border =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>),</span>
<span id="cb1-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> X1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> X2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> inside)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_ellipse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"polygon"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"norm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, </span>
<span id="cb1-42">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-45">  my_theme</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/multivariate_probability_regions/index_files/figure-html/fig-fig1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: The curve corresponding to the value <img src="https://latex.codecogs.com/png.latex?%5Cchi%5E2(0.95,2)=5.99"> contains <img src="https://latex.codecogs.com/png.latex?95%5C%25"> of the variable pairs; the points falling outside the concentration ellipse are plotted in red.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The coverage of the concentration ellipse is 94.9%. Moreover, the code calculates the area enclosed by the concentration ellipse, Equation&nbsp;9: 74 (arbitrary units).</p>
</div>
</section>
<section id="an-application-to-posturography" class="level2">
<h2 class="anchored" data-anchor-id="an-application-to-posturography">An application to posturography</h2>
<p>Postural control is often quantified by recording the trajectory of the center of pressure (CoP) during human quiet standing. This quantification has many important applications, including the assessment of balance disorders and the early detection of balance degradation to prevent falls in geriatric populations. The CoP trajectory in time, reported as the anteroposterior (AP) component (forward/backward) and the mediolateral (ML) component (left/right) paired together to form the so-called stabilogram, is typically acquired by means of a force platform, on top of which tested subjects are asked to stand in their upright posture for a while, typically 60 s, as still as possible. Manipulation of testing conditions, e.g., presence or absence of vision, different kind of surfaces for the feet to stay on are possible, so as to gain further insights about the postural control system performance.</p>
<p>Among the many CoP features that have been introduced in the literature, few of them have to do with the concentration ellipse of the CoP. E.g., the principal sway direction, to represent the relative contribution of the ML and AP components to the CoP fluctuations, in terms of the angle between the AP axis and the direction of the main eigenvector produced by the PCA. Another feature of interest, the one considered in this post, is the area of the concentration ellipse, also called the <strong>sway area</strong> <span class="citation" data-cites="schubert2014">(Schubert and Kirchner 2014)</span>. For instance, an increase in this feature value among elderly people has been associated with a higher risk of fall. I want to show here an example of calculation of the sway area using the code above, by taking an exemplary stabilogram from a recently published dataset <span class="citation" data-cites="dossantos2017">(Santos et al. 2017)</span>, Figure&nbsp;2.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggpubr)</span>
<span id="cb2-2"></span>
<span id="cb2-3">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PDS01OR1grf.txt'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-4">t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Time                  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 6000 samples acquired at a rate of 100 Hz</span></span>
<span id="cb2-5">CoP_AP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>COPNET_X<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e2</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># anteroposterior component (AP), cm</span></span>
<span id="cb2-6">CoP_ML <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>COPNET_Z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e2</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mediolateral component (ML), cm</span></span>
<span id="cb2-7">CoP_AP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> CoP_AP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(CoP_AP) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># detrending</span></span>
<span id="cb2-8">CoP_ML <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> CoP_ML <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(CoP_ML) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># detrending</span></span>
<span id="cb2-9"></span>
<span id="cb2-10">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> t, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_ap =</span> CoP_AP, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_ml =</span> CoP_ML)</span>
<span id="cb2-11"></span>
<span id="cb2-12">p_ap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> x_ap)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time, s"</span>,</span>
<span id="cb2-15">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AP direction, cm"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-17">  my_theme</span>
<span id="cb2-18"></span>
<span id="cb2-19">p_ml <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> x_ml)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time, s"</span>,</span>
<span id="cb2-22">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ML direction, cm"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-24">  my_theme</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggarrange</span>(p_ap, p_ml)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/multivariate_probability_regions/index_files/figure-html/fig-fig2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Anteroposterior and mediolateral components of the CoP for the subject with ID 1 from the Duarte’s dataset, tested Open-Eyes on a Rigid surface (first trial out of three).
</figcaption>
</figure>
</div>
</div>
</div>
<p>The stabilogram with the concentration ellipse superimposed on it are shown in Figure&nbsp;3.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x_ml, df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x_ap) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># detrending already done</span></span>
<span id="cb3-2">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qchisq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to define the 95% probability contour</span></span>
<span id="cb3-3">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(x)</span>
<span id="cb3-4">C <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cov</span>(x)                  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample covariance matrix</span></span>
<span id="cb3-5">S <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">solve</span>(C)                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inverse of C</span></span>
<span id="cb3-6">Q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(n)                        </span>
<span id="cb3-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n) Q[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(x[i, ]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> S <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> x[i, ] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># computation of the quadratic form</span></span>
<span id="cb3-8"></span>
<span id="cb3-9">df_Q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(x, Q)</span>
<span id="cb3-10">df_Q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_Q <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inside =</span> Q <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> dist)</span>
<span id="cb3-12">aest <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>df_Q<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>inside)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># estimated coverage</span></span>
<span id="cb3-13">area <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>dist<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">det</span>(C)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># area of the concentration ellipse </span></span>
<span id="cb3-14"></span>
<span id="cb3-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_Q, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> X1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> X2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> inside)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_ellipse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"polygon"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"norm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, </span>
<span id="cb3-19">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ML component, cm"</span>,</span>
<span id="cb3-21">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AP component, cm"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-24">  my_theme</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/multivariate_probability_regions/index_files/figure-html/fig-fig3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Exemplary stabilogram with superimposed the concentration ellipse - parts of the CoP trajectory outside the concentration ellipse are displayed in red.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The coverage of the concentration ellipse is 97%. The sway area is 3.09 cm<img src="https://latex.codecogs.com/png.latex?%5E2">.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-dossantos2017" class="csl-entry">
Santos, Damiana A. dos, Claudiane A. Fukuchi, Reginaldo K. Fukuchi, and Marcos Duarte. 2017. <span>“A Data Set with Kinematic and Ground Reaction Forces of Human Balance.”</span> <em>PeerJ</em> 5 (July): e3626. <a href="https://doi.org/10.7717/peerj.3626">https://doi.org/10.7717/peerj.3626</a>.
</div>
<div id="ref-schubert2014" class="csl-entry">
Schubert, Patric, and Marietta Kirchner. 2014. <span>“Ellipse Area Calculations and Their Applicability in Posturography.”</span> <em>Gait &amp; Posture</em> 39 (1): 518–22. <a href="https://doi.org/10.1016/j.gaitpost.2013.09.001">https://doi.org/10.1016/j.gaitpost.2013.09.001</a>.
</div>
</div></section></div> ]]></description>
  <category>statistics</category>
  <guid>https://amsabatini.netlify.app/posts/multivariate_probability_regions/</guid>
  <pubDate>Wed, 01 May 2024 22:00:00 GMT</pubDate>
  <media:content url="https://amsabatini.netlify.app/posts/multivariate_probability_regions/fig-cop.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Confidence intervals for proportions</title>
  <dc:creator>Angelo Maria Sabatini</dc:creator>
  <link>https://amsabatini.netlify.app/posts/probability_estimation/</link>
  <description><![CDATA[ 




<p>Consider a Bernoulli test with <img src="https://latex.codecogs.com/png.latex?n"> independent trials and <img src="https://latex.codecogs.com/png.latex?x"> successes that are recorded in the test. The proportion <img src="https://latex.codecogs.com/png.latex?f=x/n"> is assumed to be the estimate of the true probability <img src="https://latex.codecogs.com/png.latex?p">; we want to determine the values <img src="https://latex.codecogs.com/png.latex?p_1"> and <img src="https://latex.codecogs.com/png.latex?p_2"> of the confidence interval (CI) with the required confidence level associated to <img src="https://latex.codecogs.com/png.latex?f">, namely <img src="https://latex.codecogs.com/png.latex?CL=100(1-%5Calpha)%5C%25">.</p>
<p>The <strong>Clopper-Pearson equations</strong> can be used to calculate the CI:</p>
<p><span id="eq-eq1"><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0A%5Csum_%7Bk=x%7D%5E%7B%5Cinfty%7D%7Bn%5Cchoose%20k%7Dp_1%5Ek(1-p_1)%5E%7Bn-k%7D&amp;=c_1%5C%5C%0A%5Csum_%7Bk=0%7D%5Ex%7Bn%5Cchoose%20k%7Dp_2%5Ek(1-p_2)%5E%7Bn-k%7D&amp;=c_2%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A%5Ctag%7B1%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?CL=1-c_1-c_2">. One common choice for <img src="https://latex.codecogs.com/png.latex?c_1"> and <img src="https://latex.codecogs.com/png.latex?c_2"> is the symmetric interval, <img src="https://latex.codecogs.com/png.latex?c_1=c_2=(1-CL)/2">. For instance, when <img src="https://latex.codecogs.com/png.latex?CL=95%5C%25">, <img src="https://latex.codecogs.com/png.latex?%5Calpha=0.05"> and <img src="https://latex.codecogs.com/png.latex?c_1=c_2=2.5%5C%25">. The Clopper-Pearson interval is also called the exact interval, since the solution of Equation&nbsp;1 with respect to <img src="https://latex.codecogs.com/png.latex?p_1"> and <img src="https://latex.codecogs.com/png.latex?p_2"> gives the correct probability estimate, even for small samples.</p>
<p>It is noted that the binomial model has been used in Equation&nbsp;1 to capture events of the type “number of successes out of a given number of independent trials”, namely:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7BPr%7D(k%5C;%5Ctext%7Bsuccesses%20out%20of%7D%5C;n%5C;%5Ctext%7Btrials%7D)=%7Bn%5Cchoose%20k%7Dp%5Ek(1-p)%5E%7Bn-k%7D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?0%5Cleq%20k%5Cleq%20n"> and <img src="https://latex.codecogs.com/png.latex?%7Bn%5Cchoose%20k%7D"> is the number of combinations of <img src="https://latex.codecogs.com/png.latex?k">-length sequences from an <img src="https://latex.codecogs.com/png.latex?n">-length sequence (I discussed this in a previous post of mine).</p>
<p>We recall that a binomial random variable <img src="https://latex.codecogs.com/png.latex?X"> with parameters <img src="https://latex.codecogs.com/png.latex?n"> (the number of independent trials) and <img src="https://latex.codecogs.com/png.latex?p"> (the probability of success) has mean value and standard deviation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0A%5Cmu_X&amp;=np%5C%5C%0A%5Csigma_X&amp;=%5Csqrt%7Bnp(1-p)%7D%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A"></p>
<p>Therefore the random variable <img src="https://latex.codecogs.com/png.latex?F=X/n"> has mean value and standard deviation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0A%5Cmu_F&amp;=p%5C%5C%0A%5Csigma_F&amp;=%5Cfrac%7B%5Csigma_X%7D%7B%5Csqrt%7Bn%7D%7D=%5Csqrt%7B%5Cfrac%7Bp(1-p)%7D%7Bn%7D%7D%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A"></p>
<p>The normal approximation to the binomial distribution, as stated by the De Moivre-Laplace theorem, is considered as an alternative to Equation&nbsp;1 for CI construction. This theorem states that the random variable</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT=%5Cfrac%7BF-p%7D%7B%5Csigma_F%7D%0A"></p>
<p>is <em>approximately</em> normally distributed - in practice, good approximations are achieved for <img src="https://latex.codecogs.com/png.latex?np,n(1-p)%5Cgg1">.</p>
<p>Given a variate <img src="https://latex.codecogs.com/png.latex?t"> of <img src="https://latex.codecogs.com/png.latex?T">, the CI can be written as follows:</p>
<p><span id="eq-eq2"><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cvert%5C,f-p%5C,%5Cvert%7D%7B%5Csqrt%7B%5Cdfrac%7Bp(1-p)%7D%7Bn%7D%7D%7D%5Cleq%20t_%7B1-%5Calpha/2%7D%0A%5Ctag%7B2%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?t_%7B1-%5Calpha/2%7D"> is the quantile of the normal distribution at specified probability <img src="https://latex.codecogs.com/png.latex?1-%5Calpha/2">: for <img src="https://latex.codecogs.com/png.latex?%5Calpha=0.05">, <img src="https://latex.codecogs.com/png.latex?t_%7B1-%5Calpha/2%7D=1.96">.</p>
<p>Squaring Equation&nbsp;2 we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0An(f-p)%5E2%5Cleq%20t_%7B1-%5Calpha/2%7D%5E2%5C,p(1-p)%0A"></p>
<p>We can solve the resulting second-order equation <em>with respect to the unknown</em> <img src="https://latex.codecogs.com/png.latex?p">, yielding the <strong>Wilson interval</strong>:</p>
<p><span id="eq-eq3"><img src="https://latex.codecogs.com/png.latex?%0Ap%5Cin%5Cdfrac%7Bf+%5Cdfrac%7Bt%5E2_%7B1-%5Calpha/2%7D%7D%7B2n%7D%7D%7B%5Cdfrac%7Bt%5E2_%7B1-%5Calpha/2%7D%7D%7Bn%7D+1%7D%5Cpm%5Cdfrac%7Bt_%7B1-%5Calpha/2%7D%5Csqrt%7B%5Cdfrac%7Bt%5E2_%7B1-%5Calpha/2%7D%7D%7B4n%5E2%7D+%5Cdfrac%7Bf(1-f)%7D%7Bn%7D%7D%7D%7B%5Cdfrac%7Bt%5E2_%7B1-%5Calpha/2%7D%7D%7Bn%7D+1%7D%0A%5Ctag%7B3%7D"></span></p>
<p>It is noted that the Wilson interval is not centered on the measured proportion <img src="https://latex.codecogs.com/png.latex?f"> but on the value <img src="https://latex.codecogs.com/png.latex?(f+t_%7B1-%5Calpha/2%7D%5E2/2n)/(t_%7B1-%5Calpha/2%7D%5E2/n+1)">, which is a function of <img src="https://latex.codecogs.com/png.latex?f"> and the number of trials <img src="https://latex.codecogs.com/png.latex?n">. This is due to the asymmetry of the binomial distribution for small <img src="https://latex.codecogs.com/png.latex?n">.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Continuity correction
</div>
</div>
<div class="callout-body-container callout-body">
<p>The accuracy of Equation&nbsp;3 can be improved by applying the <strong>continuity correction</strong> to the proportion <img src="https://latex.codecogs.com/png.latex?f=x/n">. This correction improves the accuracy of CI construction for discrete variables when they can be approximated by normal variables:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af_%7B%5Cpm%7D=%5Cfrac%7Bx%5Cpm0.5%7D%7Bn%7D%5Crightarrow%5Cleft%5C%7B%5Cbegin%7Bsplit%7Df_%7B+%7D&amp;=%5Cmin%5Cleft(1,%5Cdfrac%7Bx+0.5%7D%7Bn%7D%5Cright)%5C%5Cf_%7B-%7D&amp;=%5Cmax%5Cleft(0,%5Cdfrac%7Bx-0.5%7D%7Bn%7D%5Cright)%5Cend%7Bsplit%7D%5Cright.%0A"></p>
<p>The interval is estimated as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap%5Cin%5B%5Cmax(0,p_%7B-%7D),%5Cmin(1,p_%7B+%7D)%5D%0A"></p>
<p>where:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap_%7B%5Cpm%7D%5Cin%5Cdfrac%7Bf_%7B%5Cpm%7D+%5Cdfrac%7Bt%5E2_%7B1-%5Calpha/2%7D%7D%7B2n%7D%7D%7B%5Cdfrac%7Bt%5E2_%7B1-%5Calpha/2%7D%7D%7Bn%7D+1%7D%5Cpm%5Cdfrac%7Bt_%7B1-%5Calpha/2%7D%5Csqrt%7B%5Cdfrac%7Bt%5E2_%7B1-%5Calpha/2%7D%7D%7B4n%5E2%7D+%5Cdfrac%7Bf_%7B%5Cpm%7D(1-f_%7B%5Cpm%7D)%7D%7Bn%7D%7D%7D%7B%5Cdfrac%7Bt%5E2_%7B1-%5Calpha/2%7D%7D%7Bn%7D+1%7D%0A"></p>
</div>
</div>
<p>The Wilson interval (with continuity correction) is generally considered valid for <img src="https://latex.codecogs.com/png.latex?n%3E10">. For <img src="https://latex.codecogs.com/png.latex?n%5Cgg1"> (namely, <img src="https://latex.codecogs.com/png.latex?n%3E30">), a very popular approximate formulation of the CI is the <strong>Wald interval</strong>:</p>
<p><span id="eq-eq4"><img src="https://latex.codecogs.com/png.latex?%0Ap%5Cin%20f%5Cpm%20t_%7B1-%5Calpha/2%7D%5Csqrt%7B%5Cdfrac%7Bf(1-f)%7D%7Bn%7D%7D%0A%5Ctag%7B4%7D"></span></p>
<p>The Wald interval, which does not require any continuity correction, is symmetric around the estimated proportion. For <img src="https://latex.codecogs.com/png.latex?n%5Cgg1"> it is noted indeed that the Wilson interval tends to become symmetric and identical to the Wald interval.</p>
<p>The question is when <img src="https://latex.codecogs.com/png.latex?n"> is large enough for these methods to produce accurate inference. The R code below is a fully reproducible code to generate coverage plots for the Wilson interval (with continuity correction) and the Wald interval.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1789</span>)</span>
<span id="cb1-2">n  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>                          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of Bernoulli trials</span></span>
<span id="cb1-3">L  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>                        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of simulated sequences </span></span>
<span id="cb1-4">a  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>                          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># confidence level</span></span>
<span id="cb1-5">t  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>a<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># quantile of the normal distribution</span></span>
<span id="cb1-6">p  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tested values of probability</span></span>
<span id="cb1-7">np <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(p)                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of tested values of probability</span></span>
<span id="cb1-8">c_wald   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(np)           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wald approach</span></span>
<span id="cb1-9">c_wilson <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(np)           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wilson approach</span></span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>np) {</span>
<span id="cb1-12">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>L) {</span>
<span id="cb1-13">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbinom</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p[i])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of successes</span></span>
<span id="cb1-14">    f <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n                               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># proportion of successes</span></span>
<span id="cb1-15">    fl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, (x<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">-0.5</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># continuity correction</span></span>
<span id="cb1-16">    fu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, (x<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">+0.5</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n) </span>
<span id="cb1-17">    CIl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (fl<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(fl<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>fl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n)</span>
<span id="cb1-18">    CIu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (fu<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(fu<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>fu)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n)</span>
<span id="cb1-19">    CI_lower_wilson <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, CIl) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wilson interval</span></span>
<span id="cb1-20">    CI_upper_wilson <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, CIu)</span>
<span id="cb1-21">    CI_lower_wald <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> f <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(f<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>f)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wald interval</span></span>
<span id="cb1-22">    CI_upper_wald <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> f <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(f<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>f)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n)</span>
<span id="cb1-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(CI_lower_wilson <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> p[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> CI_upper_wilson <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> p[i]) c_wilson[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> c_wilson[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(CI_lower_wald <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> p[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> CI_upper_wald <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> p[i]) c_wald[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> c_wald[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-25">  }</span>
<span id="cb1-26">}</span>
<span id="cb1-27">c_wilson <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>c_wilson<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>L <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># estimated coverage</span></span>
<span id="cb1-28">c_wald   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>c_wald<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>L   </span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/probability_estimation/index_files/figure-html/fig-fig1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Coverage curves for the binomial distribution with <img src="https://latex.codecogs.com/png.latex?n=30">.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The simulation results of Figure&nbsp;1 (<img src="https://latex.codecogs.com/png.latex?n=30">) show that, whereas the Wilson method tends just to provide some limited over-coverage for all values of <img src="https://latex.codecogs.com/png.latex?p"> (this is simply due to <img src="https://latex.codecogs.com/png.latex?x"> being present in both the sums of Equation&nbsp;1), the Wald interval performs poorly, with severe under-coverage, especially for low and high values of <img src="https://latex.codecogs.com/png.latex?p">. These results seem to raise objections against the use of the Wald interval, even in situations when <img src="https://latex.codecogs.com/png.latex?n%5Cgg1">: Figure&nbsp;2 shows the coverage plots in the case of <img src="https://latex.codecogs.com/png.latex?n=100">.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fig2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/probability_estimation/index_files/figure-html/fig-fig2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Coverage curves for the binomial distribution with <img src="https://latex.codecogs.com/png.latex?n=100">.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Although the performance of the Wald method has slightly improved, the Wilson method still outperforms it, especially for small and high values of <img src="https://latex.codecogs.com/png.latex?p">.</p>
<blockquote class="blockquote">
<p>To conclude, when estimating the confidence interval associated to the estimate of proportions, the Wald interval - the most basic confidence interval usually considered by experimentalists - appears to be seriously flawed, also for values of the number of trials that are considered <em>large</em> in most statistical textbooks. The Wilson interval with continuity correction tends to perform much better and its use should be encouraged.</p>
</blockquote>



 ]]></description>
  <category>statistics</category>
  <guid>https://amsabatini.netlify.app/posts/probability_estimation/</guid>
  <pubDate>Fri, 26 Apr 2024 22:00:00 GMT</pubDate>
  <media:content url="https://amsabatini.netlify.app/posts/probability_estimation/coin-toss.png" medium="image" type="image/png" height="140" width="144"/>
</item>
<item>
  <title>Pills of combinatorics</title>
  <dc:creator>Angelo Maria Sabatini</dc:creator>
  <link>https://amsabatini.netlify.app/posts/combinatorics/</link>
  <description><![CDATA[ 




<p>At least in the elementary case of finite sample spaces (i.e., a finite number of outcomes can be generated by our experiment), we often find useful to consider the intuitive notion that the outcomes are equally likely; this allows to introduce what is known as the classical definition of probability. For any set <img src="https://latex.codecogs.com/png.latex?A"> made of some collection of outcomes from the sample space, we define the probability of <img src="https://latex.codecogs.com/png.latex?A"> as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7BPr%7D(A)=%5Cfrac%7B%5Ctext%7Bnumber%20of%20cases%20in%7D%5C;A%7D%7B%5Ctext%7Bnumber%20of%20cases%20in%20the%20sample%20space%7D%7D%0A"></p>
<p>After the sample space has been defined and its size determined, we calculate probabilities of sets by counting the number of possible cases.</p>
<p>The art of counting is a relevant part of a field in mathematics known as combinatorics. In this post, I present the basic principle of counting and apply it to a number of situations that are often encountered in probabilistic models.</p>
<section id="the-counting-principle" class="level2">
<h2 class="anchored" data-anchor-id="the-counting-principle">The counting principle</h2>
<p>Consider an experiment that consists of two consecutive stages. The possible outcomes of the first stage are <img src="https://latex.codecogs.com/png.latex?a_1,%5Ccdots,a_n"> and, for each outcome from the first stage, <img src="https://latex.codecogs.com/png.latex?b_1,%5Ccdots,b_m"> outcomes are possible for the second stage. The outcomes of the two-stage experiment are thus the ordered pairs <img src="https://latex.codecogs.com/png.latex?(a_i,b_j),i=1,...,m;j=1,%5Ccdots,m">, whose number is <img src="https://latex.codecogs.com/png.latex?nm">. An obvious generalization is for an <img src="https://latex.codecogs.com/png.latex?r">-stage experiment, with <img src="https://latex.codecogs.com/png.latex?n_i,i=1,2,%5Ccdots,r"> outcomes each. The total number of outcomes is</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AN=%5Cprod_%7Bi=1%7D%5Ern_i%0A"></p>
<div id="exm-exm1" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (Number of subsets of an <img src="https://latex.codecogs.com/png.latex?n">-element set.)</strong></span> Consider an <img src="https://latex.codecogs.com/png.latex?n">-element set <img src="https://latex.codecogs.com/png.latex?%5C%7Ba_1,a_2,%5Ccdots,a_n%5C%7D">. The construction of a subset can be seen as an <img src="https://latex.codecogs.com/png.latex?n">-stage process, where, at the <img src="https://latex.codecogs.com/png.latex?i">th stage, the <img src="https://latex.codecogs.com/png.latex?i">th element is offered the opportunity to be a member of the subset or not (binary choice). Therefore the number of subsets is <img src="https://latex.codecogs.com/png.latex?N=2%5En">, inclusive of either the empty set (no elements are in one subset) or the sample space (all the elements are in another subset).</p>
</div>
<p>Consider now the situation where we have <img src="https://latex.codecogs.com/png.latex?n"> distinct objects in a box and we want to form groups by sequentially selecting <img src="https://latex.codecogs.com/png.latex?k"> objects from it, without repetitions being allowed (<strong>sampling without replacement</strong>) or with repetitions being allowed (<strong>sampling with replacement</strong>). In the former case, of course, we cannot select more objects than they are in the box, namely <img src="https://latex.codecogs.com/png.latex?k%5Cleq%20n">. In the latter case, the restriction <img src="https://latex.codecogs.com/png.latex?k%5Cleq%20n"> does not apply and, although unlikely, a group can even consist of <img src="https://latex.codecogs.com/png.latex?k"> replicas of the same object.</p>
<p>Moreover, the selection process can differ in regard to wthether we are interested in the order of selection or not. If the <strong>order of selection matters</strong>, two groups that are made by the same objects, each one with its own number of occurrences, are considered distinct, whereas, if the <strong>order of selection does not matter</strong>, they should count as one case only in the probability calculation.</p>
<p>Based on these properties, four different arrangements of <img src="https://latex.codecogs.com/png.latex?k"> out of a collection of <img src="https://latex.codecogs.com/png.latex?n"> objects have to be considered, namely (without/with) repetition-order of selection (does/does not) matter. Each arrangement has its own name and related formula of counting, as outlined in the following.</p>
</section>
<section id="sampling-without-replacement" class="level2">
<h2 class="anchored" data-anchor-id="sampling-without-replacement">Sampling without replacement</h2>
<section id="order-of-selection-matters" class="level4">
<h4 class="anchored" data-anchor-id="order-of-selection-matters">Order of selection matters</h4>
<p>The number of arrangements, called <strong>permutations</strong>, can be calculated as the result of a <img src="https://latex.codecogs.com/png.latex?k">-stage process. At the first stage, we have <img src="https://latex.codecogs.com/png.latex?n"> possible choices, at the second stage, the choices are reduced by one unit, i.e., <img src="https://latex.codecogs.com/png.latex?n-1">; when we reach the <img src="https://latex.codecogs.com/png.latex?k">-stage, we are left with <img src="https://latex.codecogs.com/png.latex?n-k+1"> choices. Applying the principle of counting, we have:</p>
<p><span id="eq-eq1"><img src="https://latex.codecogs.com/png.latex?%0AD(n,k)=n(n-1)%5Ccdots%20(n-k+1)=%5Cfrac%7Bn!%7D%7B(n-k)!%7D%0A%5Ctag%7B1%7D"></span></p>
<p>where the factorial of a non-negative integer <img src="https://latex.codecogs.com/png.latex?n">, denoted by <img src="https://latex.codecogs.com/png.latex?n!">, is the product of all positive integers less than or equal to <img src="https://latex.codecogs.com/png.latex?n">, i.e., <img src="https://latex.codecogs.com/png.latex?n!=1%5Ccdot2%5Ccdots%20n">. Recall that, when <img src="https://latex.codecogs.com/png.latex?k=n">, <img src="https://latex.codecogs.com/png.latex?D(n,n)=n!"> (<img src="https://latex.codecogs.com/png.latex?0!=1!=1">).</p>
</section>
<section id="order-of-selection-does-not-matter" class="level4">
<h4 class="anchored" data-anchor-id="order-of-selection-does-not-matter">Order of selection does not matter</h4>
<p>The number of arrangements, called <strong>combinations</strong>, can be calculated by noting that there exist <img src="https://latex.codecogs.com/png.latex?P(k,k)=k!"> sequences of length <img src="https://latex.codecogs.com/png.latex?k"> that differ from one another just in terms of the order of the presentation of their elements. They contribute only one arrangement to the total number of them:</p>
<p><span id="eq-eq2"><img src="https://latex.codecogs.com/png.latex?%0AC(n,k)=%5Cfrac%7BD(n,k)%7D%7BD(k,k)%7D=%5Cfrac%7Bn!%7D%7B(n-k)!k!%7D=%7Bn%5Cchoose%20k%7D%0A%5Ctag%7B2%7D"></span></p>
<p>where the <strong>binomial coefficient</strong> <img src="https://latex.codecogs.com/png.latex?%7Bn%5Cchoose%20k%7D">, indexed by the pair of integers <img src="https://latex.codecogs.com/png.latex?n%5Cgeq%20k%5Cgeq0">, is considered.</p>
<div id="exm-exm2" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 (Newton’s binomial theorem)</strong></span> For any real number <img src="https://latex.codecogs.com/png.latex?n"> that is not a non-negative integer, the theorem states that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bk=0%7D%5En%7Bn%5Cchoose%20k%7Da%5Ekb%5E%7Bn-k%7D=(a+b)%5En%0A"></p>
<p>when <img src="https://latex.codecogs.com/png.latex?a,b%5Cin%5Cmathbb%7BR%7D">.</p>
<p>Since <img src="https://latex.codecogs.com/png.latex?%7Bn%5Cchoose%20k%7D"> is the number of <img src="https://latex.codecogs.com/png.latex?k">-element sequences of a given <img src="https://latex.codecogs.com/png.latex?n">-element set, the sum over <img src="https://latex.codecogs.com/png.latex?k"> of <img src="https://latex.codecogs.com/png.latex?%7Bn%5Cchoose%20k%7D"> counts the number of subsets of all possible sizes. Using the result of Example&nbsp;1:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bk=0%7D%5E%7Bn%7D%7Bn%5Cchoose%20k%7D=2%5En%0A"></p>
<p>This result is also a simple application of the Newton’s binomial theorem for <img src="https://latex.codecogs.com/png.latex?a=b=1">.</p>
</div>
<p>Recall that a combination is a choice of <img src="https://latex.codecogs.com/png.latex?k"> elements out of an <img src="https://latex.codecogs.com/png.latex?n">-element set without regard to order. This is the same as partitioning the set in two: one part contains <img src="https://latex.codecogs.com/png.latex?k"> elements and the other contains the remaining <img src="https://latex.codecogs.com/png.latex?n%E2%88%92k">. We can generalize by considering partitions in more than two subsets. We have <img src="https://latex.codecogs.com/png.latex?n"> distinct objects and we are given non-negative integers <img src="https://latex.codecogs.com/png.latex?n_1,n_2,%5Ccdots,n_r">, whose sum is equal to <img src="https://latex.codecogs.com/png.latex?n">. The <img src="https://latex.codecogs.com/png.latex?n"> items are to be divided into <img src="https://latex.codecogs.com/png.latex?r"> disjoint groups, with the <img src="https://latex.codecogs.com/png.latex?i">th group containing exactly <img src="https://latex.codecogs.com/png.latex?n_i"> items. The total number of groups is given by the <strong>multinomial coefficient</strong>:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AN_r=%7Bn%5Cchoose%20n_1n_2%5Ccdots%20n_r%7D=%5Cfrac%7Bn!%7D%7Bn_1!n_2!%5Ccdots%20n_r!%7D%0A"></p>
</section>
</section>
<section id="sampling-with-replacement" class="level2">
<h2 class="anchored" data-anchor-id="sampling-with-replacement">Sampling with replacement</h2>
<section id="order-of-selection-matters-1" class="level4">
<h4 class="anchored" data-anchor-id="order-of-selection-matters-1">Order of selection matters</h4>
<p>The number of arrangements, called <strong>dispositions</strong> can be calculated as the result of a <img src="https://latex.codecogs.com/png.latex?k">-stage process. At the first stage, we have <img src="https://latex.codecogs.com/png.latex?n"> possible choices, at all the other stages, the choices are still <img src="https://latex.codecogs.com/png.latex?n">. Applying the principle of counting, we have:</p>
<p><span id="eq-eq3"><img src="https://latex.codecogs.com/png.latex?%0AD%5E*(n,k)=n%5Ek%0A%5Ctag%7B3%7D"></span></p>
</section>
<section id="order-of-selection-does-not-matter-1" class="level4">
<h4 class="anchored" data-anchor-id="order-of-selection-does-not-matter-1">Order of selection does not matter</h4>
<p>The number of arrangements, called <strong>partitions</strong> is given by:</p>
<p><span id="eq-eq4"><img src="https://latex.codecogs.com/png.latex?%0AC%5E*(n,k)=%5Cfrac%7B(n+k-1)!%7D%7Bk!(n-1)!%7D=%7Bn+k-1%5Cchoose%20k%7D%0A%5Ctag%7B4%7D"></span></p>
<p>To understand the formula of Equation&nbsp;4, think of writing <img src="https://latex.codecogs.com/png.latex?C%5E*(n,k)"> when, for instance, <img src="https://latex.codecogs.com/png.latex?n=6,k=4"> as, say, <img src="https://latex.codecogs.com/png.latex?a_1a_2a_3a_2"> or equivalently <img src="https://latex.codecogs.com/png.latex?a_1*a_2**a_3*a_4">, where any element <img src="https://latex.codecogs.com/png.latex?a_i,i=1,2,%5Ccdots,n"> is followed by a number of asterisks equal to the number of its occurrences in the sequence (the total number of asterisks in the equivalent representation needs to be equal to <img src="https://latex.codecogs.com/png.latex?k">). Another example: <img src="https://latex.codecogs.com/png.latex?a_2a_3a_3a_3"> and <img src="https://latex.codecogs.com/png.latex?a_1a_2*a_3***a_4">. It is observed that a one-to-one correspondence exists between the original arrangements and all possible permutations in the alignment of elements and asterisks in the equivalent representation. Since each alignment starts with <img src="https://latex.codecogs.com/png.latex?a_1">, we need to permute <img src="https://latex.codecogs.com/png.latex?n+k-1"> elements, among which <img src="https://latex.codecogs.com/png.latex?k"> (the asterisks) and <img src="https://latex.codecogs.com/png.latex?n-1"> (the elements <img src="https://latex.codecogs.com/png.latex?a_i,i=2,%5Ccdots,n">) are equal.</p>
</section>
</section>
<section id="formulae" class="level2">
<h2 class="anchored" data-anchor-id="formulae">Formulae</h2>
<p>In conclusion, the four different arrangements of <img src="https://latex.codecogs.com/png.latex?k"> out of a collection of <img src="https://latex.codecogs.com/png.latex?n"> objects can be computed as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A&amp;%5Cquad%5Cquad%5Ctextbf%7Bwithout%20replacement%7D&amp;%5Cquad%5Cquad%5Ctextbf%7Bwith%20replacement%7D%5C%5C%0A%5C%5C%0A%5Ctextbf%7Border%20matters%7D&amp;%5Cquad%5Cquad%5Ctext%7Bpermutations%7D&amp;%5Cquad%5Cquad%5Ctext%7Bdispositions%7D%5C%5C%0A&amp;%5Cquad%5Cquad%20D(n,k)=%5Cdfrac%7Bn!%7D%7B(n-k)!%7D&amp;%5Cquad%5Cquad%20D%5E*(n,k)=n%5Ek%5C%5C%0A%5Ctextbf%7Border%20does%20not%20matter%7D&amp;%5Cquad%5Cquad%5Ctext%7Bcombinations%7D&amp;%5Cquad%5Cquad%5Ctext%7Bpartitions%7D%5C%5C%0A&amp;%5Cquad%5Cquad%20C(n,k)=%7Bn%5Cchoose%20k%7D&amp;%5Cquad%5Cquad%20C%5E*(n,k)=%7Bn+k-1%5Cchoose%20k%7D%0A%5Cend%7Bsplit%7D%0A"></p>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<div id="exr-exr1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> Given a group of <img src="https://latex.codecogs.com/png.latex?n"> individuals, count how many subgroups can be formed having one particular person as the leader, and a number (from 0 to <img src="https://latex.codecogs.com/png.latex?n-1">) of additional members.</p>
<p><em>Answer</em> The counting principle can be applied as follows. First, we have <img src="https://latex.codecogs.com/png.latex?n"> possible choices for the leader, and once the leader is chosen, <img src="https://latex.codecogs.com/png.latex?2%5E%7Bn-1%7D"> subsets can be considered, which may include from none to all the remaining individuals of the group. We have therefore:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AN=n2%5E%7Bn-1%7D%0A"></p>
</div>
<div id="exr-exr2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> How many words that consists of four distinct letters can be formed?</p>
<p><em>Answer</em> The sample space is composed of <img src="https://latex.codecogs.com/png.latex?n=26"> elements. The sequences we are interested are formed by <img src="https://latex.codecogs.com/png.latex?k=4"> elements, repetitions are not allowed. Two words are considered distinct based on the order of appearance of the four letters into them. The number of words is then given by Equation&nbsp;1:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AN=D(n,k)=%5Cfrac%7Bn!%7D%7B(n-k)!%7D=%5Cfrac%7B26!%7D%7B22!%7D=26%5Ccdot25%5Ccdot24%5Ccdot23=358,800%0A"></p>
</div>
<div id="exr-exr3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3</strong></span> How many combinations exist using two letters out of four letters?</p>
<p><em>Answer</em> The sample is composed of <img src="https://latex.codecogs.com/png.latex?n=4"> elements. The sequences we are interested are formed by <img src="https://latex.codecogs.com/png.latex?k=2"> distinct elements, repetitions are not allowed. Two sequences are considered the same if they differ just by the order of the elements in them, namely <img src="https://latex.codecogs.com/png.latex?a_1a_2"> is the same as <img src="https://latex.codecogs.com/png.latex?a_2a_1">. The number of combinations is then given by Equation&nbsp;2:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AN=C(n,k)=%7Bn%5Cchoose%20k%7D=%5Cfrac%7B4!%7D%7B2!2!%7D=6%0A"></p>
</div>
<div id="exr-exr4" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4</strong></span> How many distinct combinations can be formed from the letters ATALANTA?</p>
<p><em>Answer</em> There are <img src="https://latex.codecogs.com/png.latex?n=8"> letters which may be arranged in <img src="https://latex.codecogs.com/png.latex?n!"> ways, but this leads to double counting. If the <img src="https://latex.codecogs.com/png.latex?k_1=4"> “A”s are permuted, then nothing is changed, and similarly for the <img src="https://latex.codecogs.com/png.latex?k_2=2"> “T”s. The total number of distinct combinations is then given by the multinomial coefficient:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AN=%5Cfrac%7Bn!%7D%7Bk_1!k_2!%7D=%5Cfrac%7B8!%7D%7B4!2!%7D=7%5Ccdot6%5Ccdot5%5Ccdot4=840%0A"></p>
</div>


</section>

 ]]></description>
  <category>probability</category>
  <guid>https://amsabatini.netlify.app/posts/combinatorics/</guid>
  <pubDate>Tue, 23 Apr 2024 22:00:00 GMT</pubDate>
  <media:content url="https://amsabatini.netlify.app/posts/combinatorics/combinatorics.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Random incidence</title>
  <dc:creator>Angelo Maria Sabatini</dc:creator>
  <link>https://amsabatini.netlify.app/posts/random_incidence/</link>
  <description><![CDATA[ 




<p>Consider the situation when the continuous time axis of our observations is partitioned into a sequence of interarrival intervals. With the term <em>arrival</em>, we designate the occurrence of everything we are interested to observe, for instance, a particle emitted from radioactive material and captured by a radiation counter, a message reaching its destination queue, maybe the bus that we are waiting for at the bus stop. Usually, probabilistic models that attempt to describe these different type of arrivals share the same assumption: namely the interarrival times (i.e., the times between successive arrivals) are modeled as independent random variables. For instance, the continuous-time Poisson process (hopefully, this is not the right model to predict the next bus arrival!) is the case where the interarrival times are modeled as independent identically exponentially distributed random variables.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exponential distribution
</div>
</div>
<div class="callout-body-container callout-body">
<p>A continuous random variable <img src="https://latex.codecogs.com/png.latex?X"> is said to be exponential, or exponentially distributed with parameter <img src="https://latex.codecogs.com/png.latex?%5Clambda">, when its cumulative distribution function (CDF) is written</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AF_X(x)=%5Ctext%7BPr%7D(X%5Cleq%20x)=1-e%5E%7B-%5Clambda%20x%7D,%5C;x%5Cgeq0%0A"></p>
<p>The probability density function (PDF) is then given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap_X(x)=%5Cfrac%7Bd%7D%7Bdx%7DF_X(x)=%5Clambda%5C,e%5E%7B-%5Clambda%20x%7D,%5C;x%5Cgeq0%0A"></p>
<p>The mean value, the mean square value and the variance of <img src="https://latex.codecogs.com/png.latex?X"> are:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Bsplit%7D%0AE%5BX%5D&amp;=%5Cint_0%5E%7B%5Cinfty%7Dxp_X(x)%5C,dx=%5Cfrac%7B1%7D%7B%5Clambda%7D%5C%5C%0AE%5BX%5E2%5D&amp;=%5Cint_0%5E%7B%5Cinfty%7Dx%5E2p_X(x)%5C,dx=%5Cfrac%7B2%7D%7B%5Clambda%5E2%7D%5C%5C%0A%5Ctext%7BVar%7D(X)&amp;=E%5BX%5E2%5D-E%5BX%5D%5E2=%5Cfrac%7B1%7D%7B%5Clambda%5E2%7D%0A%5Cend%7Bsplit%7D%0A%5Cright.%0A"></p>
<p>Integration by parts can be used to calculate the two expectations <img src="https://latex.codecogs.com/png.latex?E%5BX%5D"> and <img src="https://latex.codecogs.com/png.latex?E%5BX%5E2%5D">.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Poisson process
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider a sequence of independent exponential random variables <img src="https://latex.codecogs.com/png.latex?T_1,T_2,T_3%5Ccdots,"> with common parameter <img src="https://latex.codecogs.com/png.latex?%5Clambda">, and let these stand for the interarrival times. The arrivals are then recorded at times <img src="https://latex.codecogs.com/png.latex?T_1,T_1+T_2,T_1+T_2+T_3,%5Ccdots"> and so forth, to define a continuous-time Poisson process.</p>
<p>A Poisson process is endowed with the following important properties:</p>
<ol type="1">
<li><p><strong>Independence of non-overlapping sets of times</strong>. This is a direct consequence of the assumed independence of the interarrival times.</p></li>
<li><p><strong>Fresh-start property</strong>. The part of the Poisson process that starts at any particular time <img src="https://latex.codecogs.com/png.latex?t%3E0"> is a probabilistic replica of the Poisson process starting at time 0, and is independent of the part of the process prior to time <img src="https://latex.codecogs.com/png.latex?t">. This can be seen as a special case of point 1.</p></li>
<li><p><strong>Memoryless interarrival time distribution</strong>. If <img src="https://latex.codecogs.com/png.latex?T"> is the time of the first arrival and if we know that <img src="https://latex.codecogs.com/png.latex?T%3Et">, then the remaining time <img src="https://latex.codecogs.com/png.latex?T%E2%88%92t"> is exponentially distributed, with the same parameter <img src="https://latex.codecogs.com/png.latex?%5Clambda">:</p></li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A%5Ctext%7BPr%7D(T%3Et+s%5C,%5Cvert%5C,T%3Et)&amp;=%5Cfrac%7B%5Ctext%7BPr%7D(T%3Et+s,T%3Et)%7D%7B%5Ctext%7BPr%7D(T%3Et)%7D%5C%5C%0A&amp;=%5Cfrac%7B%5Ctext%7BPr%7D(T%3Et+s)%7D%7B%5Ctext%7BPr%7D(T%3Et)%7D=%5Cfrac%7B1-F_T(t+s)%7D%7B1-F_T(t)%7D%5C%5C%0A&amp;=%5Cfrac%7Be%5E%7B-%5Clambda(t+s)%7D%7D%7Be%5E%7B-%5Clambda%20t%7D%7D=e%5E%7B-%5Clambda%20s%7D=%5Ctext%7BPr%7D(T%3Es)%0A%5Cend%7Bsplit%7D%0A"></p>
<p>Properties 2.-3. can be rephrased saying that the ones whose life is modeled by an exponential distribution, well they should remain <em>forever young</em>: no matter how long they have lived so far, the remaining time to their death is predicted as if they are just born!</p>
</div>
</div>
<p>The term <strong>random incidence</strong> denotes the arrival of an observer at an arbitrary time <img src="https://latex.codecogs.com/png.latex?t%5E*"> into a <em>gap</em> between two consecutive arrivals in an arrival-type process that is not necessarily described by a Poisson model, Figure&nbsp;1.</p>
<div id="fig-fig1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/random_incidence/random_incidence.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="450">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Illustration of the random incidence phenomenon.
</figcaption>
</figure>
</div>
<p>We are not saying that <img src="https://latex.codecogs.com/png.latex?t%5E*"> is random; in this regard, perhaps, using the term random incidence may appear misleading. However, the interval between the time of the previous arrival <img src="https://latex.codecogs.com/png.latex?t_p"> and <img src="https://latex.codecogs.com/png.latex?t%5E*">, and the interval between <img src="https://latex.codecogs.com/png.latex?t%5E*"> and the time of the next arrival <img src="https://latex.codecogs.com/png.latex?t_n"> are random. All we need to state to start our discussion is to assume that the observer enters the arrival-type process in a situation when a previous arrival has surely occurred: probabilistically, the gap <img src="https://latex.codecogs.com/png.latex?t_n-t_p"> is then a well-defined quantity.</p>
<p>Suppose that we know the probability law of the interarrival times <img src="https://latex.codecogs.com/png.latex?Y">. Let us denote by <img src="https://latex.codecogs.com/png.latex?W"> the random variable that describes the duration of the gap entered by random incidence, <img src="https://latex.codecogs.com/png.latex?W=T_n-T_p">. Finally, we denote by <img src="https://latex.codecogs.com/png.latex?T"> the random variable that describes the waiting time for the next arrival from when the gap is entered by random incidence, <img src="https://latex.codecogs.com/png.latex?T=T_n-T%5E*">.</p>
<p>It is argued that the probability that <img src="https://latex.codecogs.com/png.latex?W"> assumes a value between <img src="https://latex.codecogs.com/png.latex?w"> and <img src="https://latex.codecogs.com/png.latex?w+dw"> is proportional to both the the duration of the gap <img src="https://latex.codecogs.com/png.latex?w"> and the relative frequency of occurrence of such gaps <img src="https://latex.codecogs.com/png.latex?p_Y(w)dw">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7BPr%7D(w%5Cleq%20W%5Cleq%20w+dw)=p_W(w)dw%5Cpropto%20w%5C,p_Y(w)dw%0A"></p>
<p>Therefore:</p>
<p><span id="eq-eq1"><img src="https://latex.codecogs.com/png.latex?%0Ap_W(w)=%5Cfrac%7Bw%5C,p_Y(w)%7D%7BE%5BY%5D%7D%0A%5Ctag%7B1%7D"></span></p>
<p>where the constant of proportionality is calculated to enforce the constraint of normalization for the PDF <img src="https://latex.codecogs.com/png.latex?p_W(w)"> of <img src="https://latex.codecogs.com/png.latex?W"> (its integral from 0 to infinity must be 1).</p>
<p>Now, given that a gap of length <img src="https://latex.codecogs.com/png.latex?w"> is entered by random incidence, we are equally likely to be anywhere within the gap. More precisely, <em>given</em> <img src="https://latex.codecogs.com/png.latex?w">, the time until the next arrival <img src="https://latex.codecogs.com/png.latex?T"> has a uniform PDF:</p>
<p><span id="eq-eq2"><img src="https://latex.codecogs.com/png.latex?%0Ap_%7BT%5Cvert%20W%7D(t%5C,%5Cvert%5C,w)=%5Cfrac%7B1%7D%7Bw%7D,%5C;0%5Cleq%20t%5Cleq%20w%0A%5Ctag%7B2%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?p_%7BT%5Cvert%20W%7D(t%5C,%5Cvert%5C,w)"> is the conditional PDF of <img src="https://latex.codecogs.com/png.latex?T"> given <img src="https://latex.codecogs.com/png.latex?W">. Using Equation&nbsp;1, Equation&nbsp;2 the joint PDF <img src="https://latex.codecogs.com/png.latex?p_%7BTW%7D(t,w)"> can be written:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap_%7BTW%7D(t,w)=p_%7BT%5Cvert%20W%7D(t%5C,%5Cvert%5C,w)%5C,p_W(w)=%5Cfrac%7Bp_Y(w)%7D%7BE%5BY%5D%7D,%5C;0%5Cleq%20t%5Cleq%20w%3C%5Cinfty%0A"></p>
<p>Finally, the marginal PDF <img src="https://latex.codecogs.com/png.latex?p_T(t)"> of the waiting time for the next arrival from when the gap is entered by random incidence can be formed simply by <em>integrating out</em> <img src="https://latex.codecogs.com/png.latex?W">:</p>
<p><span id="eq-eq3"><img src="https://latex.codecogs.com/png.latex?%0A%5Cboxed%7Bp_T(t)=%5Cint_%7Bt%7D%5E%7B%5Cinfty%7D%5Cfrac%7Bp_Y(w)%7D%7BE%5BY%5D%7Ddw=%5Cfrac%7B1-F_Y(t)%7D%7BE%5BY%5D%7D,%5C;t%5Cgeq0%7D%0A%5Ctag%7B3%7D"></span></p>
<div id="exm-exm1" class="theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> Consider a bus passenger arriving at a bus stop. The probabilistic law of the bus headways <img src="https://latex.codecogs.com/png.latex?F_Y(y)"> will determine the probability law for the waiting time until the next bus arrives, <img src="https://latex.codecogs.com/png.latex?p_T(t)"> via Equation&nbsp;3, if we ignore interactions between successive buses and assume that the arrivals are identically distributed and independent.</p>
<p>Suppose that buses maintain perfect headways, being always spaced <img src="https://latex.codecogs.com/png.latex?T_0"> minutes apart:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AF_Y(y)=%5Cleft%5C%7B%5Cbegin%7Bsplit%7D0&amp;%5Cquad%20y%3CT_0%5C%5C1&amp;%5Cquad%20y%5Cgeq%20T_0%5Cend%7Bsplit%7D%5Cright.%5Crightarrow%20p_Y(y)=%5Cdelta(y-T_0)%5Crightarrow%20E%5BY%5D=T_0%0A"></p>
<p>where the PDF is expressed in terms of a delta function located at time <img src="https://latex.codecogs.com/png.latex?T_0">. The PDF of <img src="https://latex.codecogs.com/png.latex?T"> can be written:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap_T(t)=%5Cleft%5C%7B%5Cbegin%7Bsplit%7D&amp;%5Cfrac%7B1%7D%7BT_0%7D&amp;%5Cquad%200%5Cleq%20t%5Cleq%20T_0%5C%5C&amp;0&amp;%5Cquad%20t%3ET_0%5Cend%7Bsplit%7D%5Cright.%5Crightarrow%20E%5BT%5D=%5Cfrac%7BT_0%7D%7B2%7D%0A"></p>
<p>As expected intuitively, the time until the next arrival, <em>given random incidence</em>, is uniformly distributed between <img src="https://latex.codecogs.com/png.latex?0"> and <img src="https://latex.codecogs.com/png.latex?T_0">, with mean value <img src="https://latex.codecogs.com/png.latex?E%5BT%5D=T_0/2">: if <img src="https://latex.codecogs.com/png.latex?T_0=60"> min the average waiting time is 30 min.</p>
<p>Now, suppose that the bus headways are on the hour, and fifteen minutes after the hour. Thus, the interarrival times alternate between 15 and 45 minutes. If the bus passenger shows up at the bus stop at any time uniformly distributed within a hour, she/he has to wait for an average time of 15/2 min (with probability 1/4) and 45/2 min (with probability 3/4):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AE%5BT%5D=%5Cfrac%7B15%7D%7B2%7D%5Ccdot%5Cfrac%7B1%7D%7B4%7D+%5Cfrac%7B45%7D%7B2%7D%5Ccdot%5Cfrac%7B3%7D%7B4%7D=18.75%5C;%5Ctext%7Bmin%7D%0A"></p>
<p>More formally:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AF_Y(y)=%5Cleft%5C%7B%5Cbegin%7Bsplit%7D0&amp;%5Cquad0%5Cleq%20y%3C15%5C%5C1/2&amp;%5Cquad15%5Cleq%20y%3C45%5C%5C1&amp;%5Cquad%20y%5Cgeq45%5Cend%7Bsplit%7D%5Cright.%5Crightarrow%20E%5BY%5D=30%5C;%5Ctext%7Bmin%7D%0A"></p>
<p>Using Equation&nbsp;3:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap_T(t)=%5Cleft%5C%7B%5Cbegin%7Bsplit%7D1/30&amp;%5Cquad0%5Cleq%20t%3C15%5C%5C1/60&amp;%5Cquad15%5Cleq%20t%3C45%5C%5C0&amp;%5Cquad%20t%5Cgeq45%5Cend%7Bsplit%7D%5Cright.%5Crightarrow%20E%5BT%5D=18.75%5C,%5Ctext%7Bmin%7D%0A"></p>
<p>On average, the bus passenger has to wait longer than it might be expected taking into account <img src="https://latex.codecogs.com/png.latex?E%5BY%5D"> only, namely <img src="https://latex.codecogs.com/png.latex?E%5BY%5D/2=15"> min.</p>
<blockquote class="blockquote">
<p>This is because an observer who arrives at an arbitrary time, the bus passenger in this example, is more likely to fall in a large rather than a small interarrival interval: large interarrival intervals tend therefore to determine longer waiting times!</p>
</blockquote>
</div>
<div id="exm-exm2" class="theorem example">
<p><span class="theorem-title"><strong>Example 2</strong></span> Consider the (unrealistic) case that the bus headways are Poissonian. What does this mean? Basically, we state that the interarrival times are modeled by independent exponentially distributed random variables with rate <img src="https://latex.codecogs.com/png.latex?%5Clambda"> (the rate denotes the number of arrivals per unit time):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AF_Y(y)=1-e%5E%7B-%5Clambda%20t%7D,%5C;t%5Cgeq%200%5Crightarrow%20p_Y(y)=%5Cfrac%7BF_Y(y)%7D%7Bdy%7D=%5Clambda%20e%5E%7B-%5Clambda%20t%7D,%5C;t%5Cgeq0%5Crightarrow%20E%5BY%5D=1/%5Clambda%0A"></p>
<p>Using Equation&nbsp;3:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap_T(t)=%5Clambda%20e%5E%7B-%5Clambda%20t%7D,%5C;t%5Cgeq0%0A"></p>
<p>Hence <img src="https://latex.codecogs.com/png.latex?T"> is exponentially distributed with rate <img src="https://latex.codecogs.com/png.latex?%5Clambda">. The average time of waiting is <img src="https://latex.codecogs.com/png.latex?E%5BT%5D=1/%5Clambda">. No matter when the event occurred, the observer who arrives at an arbitrary time <img src="https://latex.codecogs.com/png.latex?t%5E*"> (the bus passenger in this example) sees the Poisson process to start fresh at time <img src="https://latex.codecogs.com/png.latex?t%5E*">, Figure&nbsp;1. It is worth noting that, according to the properties of independence, start-fresh and memorylessness stated above, we can run a Poisson process either forwards or backwards in time, without any modification in its properties. Hence, not only <img src="https://latex.codecogs.com/png.latex?T_n-T%5E*">, but also <img src="https://latex.codecogs.com/png.latex?T%5E*-T_p"> is exponentially distributed with parameter <img src="https://latex.codecogs.com/png.latex?%5Clambda">. Moreover, <img src="https://latex.codecogs.com/png.latex?T_n-T%5E*"> and <img src="https://latex.codecogs.com/png.latex?T_n-T%5E*"> are independent. We have therefore established that the gap <img src="https://latex.codecogs.com/png.latex?W"> entered by random incidence is the sum of two independent exponential random variables with parameter <img src="https://latex.codecogs.com/png.latex?%5Clambda"> and mean value <img src="https://latex.codecogs.com/png.latex?2/%5Clambda">. More formally, using Equation&nbsp;1 we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap_W(w)=%5Clambda%20w%5C,e%5E%7B-%5Clambda%20w%7D,%5C;w%5Cgeq0%0A"></p>
<p>We recall that the random variable <img src="https://latex.codecogs.com/png.latex?X"> Erlang of order <img src="https://latex.codecogs.com/png.latex?k"> has PDF:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap(x)=%5Cfrac%7B%5Clambda%5Ekx%5E%7Bk-1%7De%5E%7B-%5Clambda%20x%7D%7D%7B(k-1)!%7D%0A"></p>
<p>In conclusion, the gap duration is a random variable Erlang of order 2.</p>
<blockquote class="blockquote">
<p>In a similar fashion to Example&nbsp;1, when landing into a Poisson process at an arbitrary time, we are more likely to fall in a large interarrival interval; therefore, the length of what we perceive as a <em>typical</em> interarrival interval is greater than it is in reality.</p>
</blockquote>
</div>



 ]]></description>
  <category>probability</category>
  <guid>https://amsabatini.netlify.app/posts/random_incidence/</guid>
  <pubDate>Sun, 21 Apr 2024 22:00:00 GMT</pubDate>
  <media:content url="https://amsabatini.netlify.app/posts/random_incidence/bus.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Frequency resolution of spectral analysis</title>
  <dc:creator>Angelo Maria Sabatini</dc:creator>
  <link>https://amsabatini.netlify.app/posts/resolution/</link>
  <description><![CDATA[ 




<p><strong>Frequency resolution</strong> is the size of the smallest frequency for which details in the frequency response and the spectrum can be resolved by the estimate. For example, a resolution of 0.1 Hz means that the frequency response variations at frequency intervals at or below 0.1 Hz cannot be resolved.</p>
<p>Consider an analog band-limited signal <img src="https://latex.codecogs.com/png.latex?x(t)"> with bandwidth <img src="https://latex.codecogs.com/png.latex?B"> Hz; <img src="https://latex.codecogs.com/png.latex?x(t)"> is observed over a <strong>sample period</strong> of <img src="https://latex.codecogs.com/png.latex?T_r"> s (the length of the data record) and sampled at a <strong>sampling frequency</strong> of <img src="https://latex.codecogs.com/png.latex?f_s"> Hz (<img src="https://latex.codecogs.com/png.latex?T_s=1/f_s"> denotes the <strong>sampling interval</strong>). The total available number of samples of <img src="https://latex.codecogs.com/png.latex?x(t)"> is <img src="https://latex.codecogs.com/png.latex?N=%5Clfloor%20T_r/T_s%5Crfloor">, where <img src="https://latex.codecogs.com/png.latex?%5Clfloor%5Ccdot%5Crfloor"> denotes the floor function (or greatest integer function), namely the function that takes as input a real number <img src="https://latex.codecogs.com/png.latex?r"> and gives as output the greatest integer less than or equal to <img src="https://latex.codecogs.com/png.latex?r">.</p>
<p>According to the Shannon-Nyquist sampling theorem, if the sampling frequency <img src="https://latex.codecogs.com/png.latex?f_s"> is chosen to be <img src="https://latex.codecogs.com/png.latex?2B">, the maximum resolvable frequency is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af_%7B%5Ctext%7Bmax%7D%7D=%5Cfrac%7Bf_s%7D%7B2%7D%0A"></p>
<p>On the other hand, the minimum resolvable frequency is inversely related to the sample period:</p>
<p><span id="eq-eq1"><img src="https://latex.codecogs.com/png.latex?%0Af_%7B%5Ctext%7Bmin%7D%7D=%5Cfrac%7B1%7D%7BT_r%7D=%5Cfrac%7B1%7D%7BNT_s%7D%0A%5Ctag%7B1%7D"></span></p>
<p>and hence the number of frequencies that can be resolved from <img src="https://latex.codecogs.com/png.latex?f_%7B%5Ctext%7Bmin%7D%7D"> to <img src="https://latex.codecogs.com/png.latex?f_%7B%5Ctext%7Bmax%7D%7D"> is</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AN_f=%5Cfrac%7Bf_%7B%5Ctext%7Bmax%7D%7D-f_%7B%5Ctext%7Bmin%7D%7D%7D%7B%5CDelta%20f%7D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5CDelta%20f"> is the frequency resolution. Since <img src="https://latex.codecogs.com/png.latex?%5CDelta%20f=f_%7B%5Ctext%7Bmin%7D%7D">, I also have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AN_f=%5Cdfrac%7B%5Cdfrac%7Bf_s%7D%7B2%7D-%5Cdfrac%7Bf_s%7D%7BN%7D%7D%7B%5Cdfrac%7Bf_s%7D%7BN%7D%7D=%5Cfrac%7BN%7D%7B2%7D-1%0A"></p>
<p>This implies that will be <img src="https://latex.codecogs.com/png.latex?N/2"> discrete frequencies from <img src="https://latex.codecogs.com/png.latex?0"> to <img src="https://latex.codecogs.com/png.latex?f_%7B%5Ctext%7Bmax%7D%7D">.</p>
<p>The accurate detection of frequency components in the spectrum <img src="https://latex.codecogs.com/png.latex?X(f)"> of the signal <img src="https://latex.codecogs.com/png.latex?x(t)"> is challenged by the phenomenon known as <strong>spectral leakage</strong>, or amplitude ambiguity; it consists of ambiguous and false amplitudes occurring in the spectrum <img src="https://latex.codecogs.com/png.latex?X(f)"> whenever the sample period <img src="https://latex.codecogs.com/png.latex?T_r"> is not an integer multiple of <em>all</em> of the contributory periods in <img src="https://latex.codecogs.com/png.latex?x(t)">. That is, false or ambiguous amplitudes will occur at frequencies that are immediately adjacent to the actual frequency.</p>
<p>For aperiodic signals, <img src="https://latex.codecogs.com/png.latex?T_r"> theoretically must be infinite. For periodic signals, <img src="https://latex.codecogs.com/png.latex?T_r"> <em>must be equal to the least common integer multiple of all the periods contained in the signal</em>. Application of the DFT (Discrete Fourier Transform) or FFT (Fast Fourier Transform) to an aperiodic signal implicitly assumes that the signal is infinite in length and formed by repeating the signal of length <img src="https://latex.codecogs.com/png.latex?T_r"> an infinite number of times. This leads to discontinuities in the amplitude that occur at each integer multiple of <img src="https://latex.codecogs.com/png.latex?T_r">. These discontinuities are step-like, which introduce false amplitudes that decrease around the main frequencies.</p>
<p><em>All the periods contained in the signal cannot be known before the spectral analysis is performed</em>, therefore the stated condition on the sample period cannot be fulfilled; the best method to minimize the effect of spectral leakage is <strong>windowing</strong>.</p>
<p>Herein, I just provide a brief explanation of windowing, without testing it in the examples to follow. Windowing reduces the amplitude of the discontinuities at the boundaries of each finite sequence of samples of <img src="https://latex.codecogs.com/png.latex?x(t)">. It does so by multiplying the acquired sequence by a finite-length window with an amplitude that varies smoothly and gradually toward zero at the edges. This makes the endpoints of the waveform meet and, therefore, results in a continuous waveform without sharp transitions.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Can discrete-time sinusoids be non-periodic?
</div>
</div>
<div class="callout-body-container callout-body">
<p>The normalized frequency <img src="https://latex.codecogs.com/png.latex?f"> in cycles per sample of a <strong>discrete-time sinusoid</strong>:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax%5Bn%5D=%5Ccos(2%5Cpi%20fn)%0A"></p>
<p>is restricted to values in the interval <img src="https://latex.codecogs.com/png.latex?-1/2%5Cleq%20f%5Cleq1/2">. This is because, for any discrete-time sinusoid with frequency <img src="https://latex.codecogs.com/png.latex?%5Cvert%20f%5Cvert%3E1/2">, an integer <img src="https://latex.codecogs.com/png.latex?m"> exists such that <img src="https://latex.codecogs.com/png.latex?f=f_0+m"> and <img src="https://latex.codecogs.com/png.latex?%5Cvert%20f_0%5Cvert%5Cleq1/2">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ccos%202%5Cpi%20fn=%5Ccos%5B2%5Cpi%20(f_0+m)%5C,n%5D=%5Ccos(2%5Cpi%20f_0n)+%5Ccos(2%5Cpi%20mn)=%5Ccos(2%5Cpi%20f_0n)%0A"></p>
<p>It is worth noting that the highest rate of oscillation of discrete-time sinusoids is when, at every time instant, the output sample flips polarity with respect to the previous output sample:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af_0=%5Cfrac%7B1%7D%7B2%7D%5Crightarrow%5Ccos(2%5Cpi%20f_0n)=%5Ccos(%5Cpi%20n)=(-1)%5En%0A"></p>
<p>Moreover, a discrete-time sinusoid can be periodic, i.e, characterized by patterns that exactly repeat themselves in time, if and only if its frequency can be expressed in terms of a rational number; moreover, an additive mixture of periodical discrete-time sinusoids (called here <strong>sinusoidal mixture</strong>) is periodic with period equal to the least common integer multiple of their periods.</p>
</div>
</div>
<p>As outlined above, a spectrum line at frequency <img src="https://latex.codecogs.com/png.latex?f"> will be accurately represented by the DFT when <img src="https://latex.codecogs.com/png.latex?f_s%5Cgeq2f_%7B%5Ctext%7Bmax%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?T_r%20=%20mT">, where <img src="https://latex.codecogs.com/png.latex?m=1,2,%5Ccdots">, and <img src="https://latex.codecogs.com/png.latex?T=1/f">. This implies that <img src="https://latex.codecogs.com/png.latex?N=mf_s/f">. If <img src="https://latex.codecogs.com/png.latex?T_r"> is not an integer multiple of <img src="https://latex.codecogs.com/png.latex?T">, leakage will occur in the DFT. This appears as amplitudes at <img src="https://latex.codecogs.com/png.latex?f"> spilling onto adjacent frequencies.</p>
<p>As an example, consider a sinusoidal mixture with three unit-amplitude components at 2.875 Hz, 3 Hz, 3.125 Hz. The sampling frequency is set to <img src="https://latex.codecogs.com/png.latex?f_s=16"> Hz and the sample period to <img src="https://latex.codecogs.com/png.latex?T=8"> s (<img src="https://latex.codecogs.com/png.latex?N=128">): the component at 2.875 Hz is observed for 23 periods, the component at 3 Hz for 24 periods, and the component at 3.125 Hz for 25 periods. The resolution calculated according to Equation&nbsp;1 is 0.125 Hz.</p>
<p>A chunk of code written in MATLAB (Natick, Massachusetts: The MathWorks, Inc., <a href="https://www.mathworks.com" class="uri">https://www.mathworks.com</a>) shows how to simulate the sinusoidal mixture and to perform spectral analysis.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% *****************************</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% sinusoidal mixture generation</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% *****************************</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fs</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% sampling frequency, Hz</span></span>
<span id="cb1-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Ts</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% sampling interval, s</span></span>
<span id="cb1-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">T</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% sample period, s</span></span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Ts</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">T</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Ts</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% time domain, s</span></span>
<span id="cb1-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">N</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">length</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% number of samples</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.9375</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% frequency component 1, Hz</span></span>
<span id="cb1-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% frequency component 2, Hz</span></span>
<span id="cb1-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0625</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% frequency component 3, Hz</span></span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cos</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f1</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% sinusoid 1</span></span>
<span id="cb1-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cos</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f2</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% sinusoid 2</span></span>
<span id="cb1-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cos</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f3</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% sinusoid 3</span></span>
<span id="cb1-19"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">X</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% sinusoidal mixture</span></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% ********************************************************</span></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% calculation of single-side spectrum (see comments below)</span></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% ********************************************************</span></span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">P</span>              <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fft</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">X</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">N</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% FFT calculation</span></span>
<span id="cb1-26"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">P2</span>             <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">abs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">P</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">N</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% double-side spectrum, rescaled by N     </span></span>
<span id="cb1-27"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">P1</span>             <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">P2</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">N</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>  </span>
<span id="cb1-28"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">P1</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">P1</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb1-29"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Y</span>              <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">P1</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% single-side spectrum</span></span>
<span id="cb1-30"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span>              <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">N</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.*</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fs</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">N</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% frequency domain, Hz</span></span></code></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comments
</div>
</div>
<div class="callout-body-container callout-body">
<p>The documentation in MATLAB explains the procedure to convert the N-points FFT spectrum of the signal to the single-side amplitude spectrum:</p>
<ol type="1">
<li><p>Because the FFT function includes a scaling factor N between the original and the transformed signals, rescale the spectrum by dividing by N.</p></li>
<li><p>Take the complex magnitude of the FFT spectrum. The two-side amplitude spectrum P2, where the spectrum in the positive frequencies is the complex conjugate of the spectrum in the negative frequencies, has half the peak amplitudes of the time-domain signal.</p></li>
<li><p>To convert to the single-side spectrum Y, take the first half P1 of the two-side spectrum P2 and multiply by 2. P1(1) and P1(end) are not multiplied by 2 because these amplitudes correspond to the zero and Nyquist frequencies, respectively, and they do not have the complex conjugate pairs in the negative frequencies.</p></li>
<li><p>Define the frequency domain f for the single-side spectrum Y.</p></li>
</ol>
</div>
</div>
<p>The single-side spectrum of the sinusoidal mixture is shown in Figure&nbsp;1.</p>
<div id="fig-fig1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/resolution/spectrum.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="600">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Single-side spectrum of the sinusoidal mixture composed of three components at 2.875 Hz, 3 Hz, 3.125 Hz; sampling frequency: 16 Hz; sample period: 8 s. For the sake of visualization the frequency interval shown is limited to 2.5-3.5 Hz.
</figcaption>
</figure>
</div>
<p>Consider now the case that the three components of the sinusoidal mixture have frequencies 2.9375 Hz, 3 Hz, 3.0625 Hz. To resolve them, I would need to double the frequency resolution of the FFT, up to 0.0625 Hz, with respect to the scenario of Figure&nbsp;1. Erroneously, I double the sampling frequency. However, this expedient leaves the frequency resolution unaltered, since doubling the sample period without touching the sample period also doubles the number of samples. Moreover, the sample period is not properly chosen to avoid spectral leakage, as clearly seen in Figure&nbsp;2.</p>
<div id="fig-fig2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/resolution/spectrum1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="600">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Single-side spectrum of the sinusoidal mixture composed of three components at 2.9375 Hz, 3 Hz, 3.0625 Hz; sampling frequency: 32 Hz; sample period: 8 s.
</figcaption>
</figure>
</div>
<p>To resolve the components of the sinusoidal mixture and avoid spectral leakage, the frequency resolution of 0.0625 Hz can be achieved by extending the time period to <img src="https://latex.codecogs.com/png.latex?T_r=16"> s, which corresponds to <img src="https://latex.codecogs.com/png.latex?N=256"> samples at the original sampling frequency <img src="https://latex.codecogs.com/png.latex?f_s=16"> Hz, see Figure&nbsp;3.</p>
<div id="fig-fig3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://amsabatini.netlify.app/posts/resolution/spectrum2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="600">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Single-side spectrum of the sinusoidal mixture composed of three components at 2.9375 Hz, 3 Hz, 3.0625 Hz; sampling frequency: 16 Hz; sample period: 16 s.
</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>To conclude: whereas the sampling frequency sets the time resolution, the sample period occupies a central place in setting the frequency resolution when spectral analysis is performed. The sample period being the same, just increasing the sampling frequency simply increases the number of samples by the same ratio, leaving their ratio unaltered. The only means to increase the frequency resolution is to increase the sample period, trying at the same time to minimize the effects of spectral leakage.</p>
</blockquote>



 ]]></description>
  <category>signal processing</category>
  <guid>https://amsabatini.netlify.app/posts/resolution/</guid>
  <pubDate>Fri, 12 Apr 2024 22:00:00 GMT</pubDate>
  <media:content url="https://amsabatini.netlify.app/posts/resolution/FFT-Time-Frequency-View.png" medium="image" type="image/png" height="101" width="144"/>
</item>
</channel>
</rss>
